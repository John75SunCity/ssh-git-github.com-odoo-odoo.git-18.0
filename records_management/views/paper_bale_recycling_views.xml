<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="paper_bale_recycling_view_tree" model="ir.ui.view">
            <field name="name">paper.bale.recycling.view.tree</field>
            <field name="model">paper.bale.recycling</field>
            <field name="arch" type="xml">
                <list string="Paper Bale Recycling" decoration-success="state=='processed'" decoration-info="state=='pending'" decoration-muted="state=='cancelled'">
                    <field name="name" />
                    <field name="bale_id" />
                    <field name="processing_date" />
                    <field name="bale_weight" sum="Total Weight (kg)" />
                    <field name="recycling_facility_id" />
                    <field name="state" widget="badge" decoration-success="state == 'processed'" decoration-info="state == 'pending'" />
                </list>
            </field>
        </record>
        <record id="paper_bale_recycling_view_form" model="ir.ui.view">
            <field name="name">paper.bale.recycling.view.form</field>
            <field name="model">paper.bale.recycling</field>
            <field name="arch" type="xml">
                <form string="Paper Bale Recycling">
                    <header>
                        <button name="action_process" string="Mark Processed" type="object" class="btn-primary" invisible="state != 'pending'" />
                        <button name="action_cancel" string="Cancel" type="object" class="btn-secondary" invisible="state == 'processed'" />
                        <field name="state" widget="statusbar" statusbar_visible="pending,processed,cancelled" />
                    </header>
                    <sheet>
                        <div class="oe_title">
                            <h1>
                                <field name="name" readonly="1" />
                            </h1>
                        </div>
                        <group>
                            <group name="basic_info" string="Recycling Information">
                                <field name="bale_id" options="{'no_create': True}" />
                                <field name="processing_date" />
                                <field name="collection_date" />
                                <field name="recycling_facility_id" options="{'no_create': True}" />
                            </group>
                            <group name="weight_info" string="Weight Information">
                                <field name="bale_weight" readonly="1" />
                            </group>
                        </group>
                        <group>
                            <group name="financial_info" string="Financial Information">
                                <field name="market_price_per_ton" />
                                <field name="processing_cost" />
                                <field name="total_revenue" readonly="1" />
                                <field name="net_profit" readonly="1" />
                            </group>
                            <group name="environmental_info" string="Environmental Impact">
                                <field name="carbon_footprint_reduction" />
                                <field name="water_savings" />
                                <field name="energy_savings" />
                            </group>
                        </group>
                        <group name="notes_info" string="Notes">
                            <field name="notes" nolabel="1" />
                        </group>
                        <group name="system_info" string="System Information">
                            <field name="company_id" groups="base.group_multi_company" />
                            <field name="active" widget="boolean_toggle" />
                        </group>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" />
                        <field name="activity_ids" />
                        <field name="message_ids" />
                    </div>
                </form>
            </field>
        </record>
        <record id="paper_bale_recycling_view_kanban" model="ir.ui.view">
            <field name="name">paper.bale.recycling.view.kanban</field>
            <field name="model">paper.bale.recycling</field>
            <field name="arch" type="xml">
                <kanban default_group_by="state" class="o_kanban_small_column">
                    <field name="name" />
                    <field name="bale_id" />
                    <field name="processing_date" />
                    <field name="state" />
                    <field name="bale_weight" />
                    <templates>
                        <t t-name="card">
                            <div class="oe_kanban_global_click">
                                <div class="o_kanban_record_top">
                                    <div class="o_kanban_record_headings">
                                        <strong class="o_kanban_record_title">
                                            <field name="name" />
                                        </strong>
                                        <span class="float-end">
                                            <field name="state" widget="label_selection" options="{'classes': {'pending': 'info', 'processed': 'success', 'cancelled': 'secondary'}}" />
                                        </span>
                                    </div>
                                    <span class="o_kanban_record_subtitle text-muted">
                                        <field name="bale_id" /> ‚Ä¢ <field name="bale_weight" /> kg
                                    </span>
                                </div>
                                <div class="o_kanban_record_body">
                                    <div class="row">
                                        <div class="col-12">
                                            <strong>Processing Date:</strong>
                                            <field name="processing_date" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>
        <record id="paper_bale_recycling_view_search" model="ir.ui.view">
            <field name="name">paper.bale.recycling.view.search</field>
            <field name="model">paper.bale.recycling</field>
            <field name="arch" type="xml">
                <search string="Paper Bale Recycling">
                    <field name="name" />
                    <field name="bale_id" />
                    <field name="recycling_facility_id" />
                    <separator />
                    <filter string="Pending" name="pending" domain="[('state', '=', 'pending')]" />
                    <filter string="Processed" name="processed" domain="[('state', '=', 'processed')]" />
                    <filter string="Cancelled" name="cancelled" domain="[('state', '=', 'cancelled')]" />
                    <separator />
                    <filter string="Today" name="today" domain="[('processing_date', '=', context_today)]" />
                    <filter string="This Week" name="this_week" domain="[('processing_date', '&gt;=', (context_today - datetime.timedelta(days=7)).strftime('%Y-%m-%d'))]" />
                    <filter string="This Month" name="this_month" domain="[('processing_date', '&gt;=', (context_today.replace(day=1)).strftime('%Y-%m-%d'))]" />
                    <group expand="0" string="Group By">
                        <filter string="State" name="group_state" context="{'group_by': 'state'}" />
                        <filter string="Processing Date" name="group_processing_date" context="{'group_by': 'processing_date'}" />
                        <filter string="Recycling Facility" name="group_facility" context="{'group_by': 'recycling_facility_id'}" />
                    </group>
                </search>
            </field>
        </record>
        <record id="action_paper_bale_recycling" model="ir.actions.act_window">
            <!-- OPTIMIZATION: Model paper.bale.recycling has state field - consider using default search filters -->
            <field name="name">Paper Bale Recycling</field>
            <field name="res_model">paper.bale.recycling</field>
            <field name="view_mode">list,form</field>
            <field name="search_view_id" ref="paper_bale_recycling_view_search" />
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    <i class="fa fa-recycle"/> No recycling records yet!
                </p>
                <p>
                    <b>‚ö†Ô∏è Prerequisites:</b>
                </p>
                <ul>
                    <li>‚úì <b>Paper Bale Shipped</b> - Go to: <i>Operations &gt; Paper Recycling &gt; Paper Bales</i> (status: Shipped)</li>
                    <li>‚úì <b>Recycling Facility Configured</b> - Go to: <i>Contacts</i> (mills with recycling operations)</li>
                    <li>‚úì <b>Market Rates Current</b> - Update pricing per ton by grade (changes monthly)</li>
                </ul>
                <p>
                    <b>üìã Recycling Processing Workflow:</b>
                </p>
                <ol>
                    <li>Paper bale arrives at recycling mill (scanned upon delivery)</li>
                    <li>System auto-creates <b>Recycling Record</b> in <b>Pending</b> status</li>
                    <li>Record captures: <b>Bale ID</b>, <b>Weight</b>, <b>Grade</b>, <b>Delivery Date</b></li>
                    <li>Mill confirms <b>Collection Date</b> (when bale unloaded at facility)</li>
                    <li>Enter <b>Processing Date</b> (when mill begins recycling)</li>
                    <li>Select <b>Recycling Facility</b> (specific mill location)</li>
                    <li>System retrieves current <b>Market Price Per Ton</b> for grade</li>
                    <li>Enter mill's <b>Processing Cost</b> (handling/sorting fee)</li>
                    <li>System auto-calculates <b>Total Revenue</b>: Weight √ó Price Per Ton</li>
                    <li>System auto-calculates <b>Net Profit</b>: Total Revenue - Processing Cost</li>
                    <li>Record environmental impact: <b>Carbon Footprint Reduction</b> (CO2 saved vs virgin paper)</li>
                    <li>Add <b>Water Savings</b> (gallons saved vs virgin pulp production)</li>
                    <li>Add <b>Energy Savings</b> (kWh saved vs virgin paper manufacturing)</li>
                    <li>Click <b>Mark Processed</b> to finalize (status: Processed)</li>
                    <li>Revenue recognized, bale permanently removed from inventory</li>
                    <li>Environmental metrics aggregate for sustainability reporting</li>
                </ol>
                <p>
                    <b>üìä Recycling Record States:</b>
                </p>
                <ul>
                    <li><b>Pending:</b> Bale delivered to mill, awaiting processing confirmation</li>
                    <li><b>Processed:</b> Mill completed recycling, revenue recognized, metrics logged</li>
                    <li><b>Cancelled:</b> Bale rejected by mill (contamination), returned or downgraded</li>
                </ul>
                <p>
                    <b>üå± Environmental Impact Calculations:</b>
                </p>
                <ul>
                    <li><b>Carbon Footprint Reduction:</b> 2.5 metric tons CO2 saved per ton of recycled paper</li>
                    <li><b>Water Savings:</b> 7,000 gallons saved per ton (vs virgin pulp production)</li>
                    <li><b>Energy Savings:</b> 4,100 kWh saved per ton (vs virgin paper manufacturing)</li>
                    <li><b>Tree Savings:</b> 17 trees saved per ton of recycled paper (not logged in system yet)</li>
                </ul>
                <p>
                    <b>üöÄ Key Features:</b><br/>
                    ‚Ä¢ <b>Auto-Revenue Calculation:</b> Weight √ó current market rate by grade<br/>
                    ‚Ä¢ <b>Net Profit Tracking:</b> Revenue - processing fees = profit per bale<br/>
                    ‚Ä¢ <b>Environmental Metrics:</b> CO2, water, energy savings for sustainability reports<br/>
                    ‚Ä¢ <b>Mill Integration:</b> Links to recycling facility contact + delivery tracking<br/>
                    ‚Ä¢ <b>Grade-Based Pricing:</b> WHT &gt; OCC &gt; MIX &gt; NEWS (market rates vary)<br/>
                    ‚Ä¢ <b>Aggregated Reporting:</b> Total tonnage recycled, revenue, environmental impact<br/>
                    ‚Ä¢ <b>Kanban Workflow:</b> Visual pipeline from Pending ‚Üí Processed by facility<br/>
                    ‚Ä¢ <b>Historical Tracking:</b> Compare processing times, costs, revenues over time<br/>
            </p>
            <p>
                <b>üí° Pro Tips:</b><br/>
                ‚Ä¢ Update <b>Market Price Per Ton</b> monthly - prices fluctuate 20-30% seasonally<br/>
                ‚Ä¢ Use <b>Kanban view</b> grouped by facility to see pipeline at each mill<br/>
                ‚Ä¢ Filter by <b>This Month</b> to calculate monthly recycling revenue<br/>
                ‚Ä¢ Export <b>environmental metrics</b> for annual sustainability reports (ESG compliance)<br/>
                ‚Ä¢ Review <b>Net Profit</b> by grade - focus collections on highest-margin grades<br/>
                ‚Ä¢ <b>Group by Facility</b> to compare which mills offer best pricing/service<br/>
            </p>
            </field>
        </record>
    </data>
</odoo>
