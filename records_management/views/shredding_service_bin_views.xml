<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
<!-- ============================================================================ -->
<!-- SHREDDING SERVICE BIN VIEWS -->
<!-- ============================================================================ -->

<!-- List View -->
    <record id="shredding_service_bin_view_tree" model="ir.ui.view">
        <field name="name">shredding.service.bin.view.tree</field>
        <field name="model">shredding.service.bin</field>
        <field name="arch" type="xml">
        <list string="Shredding Service Bins" decoration-success="status == 'active'"
                decoration-warning="status == 'maintenance'" decoration-danger="status == 'retired'">
        <field name="barcode"/>
        <field name="bin_size" widget="badge"/>
        <field name="status" widget="badge"/>
        <field name="current_customer_id"/>
        <field name="location_id"/>
        <field name="last_service_date" widget="date"/>
        <field name="total_services_count"/>
        <field name="current_period_services"/>
        <field name="base_rate_per_service" widget="monetary"/>
        <field name="last_service_date" widget="datetime"/>
</list>
    </field>
    </record>

<!-- Form View -->
    <record id="shredding_service_bin_view_form" model="ir.ui.view">
        <field name="name">shredding.service.bin.view.form</field>
        <field name="model">shredding.service.bin</field>
        <field name="arch" type="xml">
        <form string="Shredding Service Bin">
            <header>
                <button name="action_report_bin_issue" string="Report Issue" type="object"
class="btn-warning" icon="fa-exclamation-triangle" title="Report Bin Issues"/>
                <button name="action_create_service_event" string="Create Service" type="object"
class="btn-primary" icon="fa-calendar" title="Create Service Event"
                        invisible="status == 'retired'"/>
                <button name="action_enable_manual_override" string="Manual Override" type="object"
class="btn-success" icon="fa-wrench" title="Enable Manual Override"
                        invisible="manual_size_override == True"/>
                <button name="action_view_work_orders" string="View Work Orders" type="object"
class="btn-primary" icon="fa-tasks" title="View Work Orders"
                        invisible="not current_work_order_id"/>
        <field name="status" widget="statusbar"
                        statusbar_visible="available,active,maintenance,retired"/>
            </header>

            <sheet>
                <div class="oe_button_box" name="button_box">
<button name="action_view_service_history" type="object" class="oe_stat_button" icon="fa-history" title="Service History">
                        <div class="o_field_widget o_stat_info">
                            <span class="o_stat_value"><field name="total_services_count"/></span>
                            <span class="o_stat_text">Services</span>
                        </div>
                    </button>
<button name="action_view_work_orders" type="object" class="oe_stat_button" icon="fa-wrench" title="Work Orders">
                        <div class="o_field_widget o_stat_info">
                            <span class="o_stat_value"><field name="current_period_services"/></span>
                            <span class="o_stat_text">Period Services</span>
                        </div>
                    </button>
                </div>

                <div class="oe_title">
                    <h1>
        <field name="barcode" readonly="1"/>
                    </h1>
                    <h2>
        <field name="bin_size" widget="selection_badge" readonly="1"/>
                    </h2>
                </div>

                <group>
                    <group name="basic_info" string="Bin Information">
        <field name="display_name"/>
        <field name="bin_size" readonly="1"/>
        <field name="barcode"/>
        <field name="weight_capacity_lbs" widget="float"/>
        <field name="volume_capacity_cf" widget="float"/>
                    </group>

                    <group name="current_status" string="Current Status">
        <field name="current_customer_id" options="{'no_create': True}"/>
        <field name="location_id"/>
        <field name="current_department_id"/>
        <field name="last_scan_location_id"/>
        <field name="last_service_date"/>
                    </group>
                </group>

                <notebook>
                    <page string="Service Information" name="service_info">
                        <group>
                            <group name="service_tracking" string="Service Tracking">
        <field name="last_service_date"/>
        <field name="total_services_count"/>
        <field name="current_period_services"/>
        <field name="estimated_weight_per_service" widget="float"/>
        <field name="service_summary" readonly="1"/>
                            </group>

                            <group name="billing_info" string="Billing Information">
        <field name="base_rate_per_service" widget="monetary"/>
        <field name="currency_id" invisible="1"/>
                            </group>
                        </group>

                        <group name="service_notes" string="Service Notes">
        <field name="service_summary" nolabel="1" placeholder="Service summary..."/>
                        </group>
                    </page>



                        <page string="Service History" name="service_history">
                            <group>
                                <group name="service_stats" string="Service Statistics">
            <field name="current_period_services" readonly="1"/>
            <field name="total_services_count" readonly="1"/>
            <field name="last_service_date" readonly="1"/>
            <field name="base_rate_per_service" readonly="1"/>
                                </group>
                                <group name="billing_info" string="Billing Information">
            <field name="base_rate_per_service" readonly="1"/>
                                </group>
                            </group>
                            <separator string="Service Events"/>
                            <field name="service_event_ids" readonly="1"/>
                        </page>

                    <page string="Work Orders" name="work_orders">
                        <group>
                            <group name="fsm_info" string="FSM Integration">
                                <field name="shredding_service_id" options="{'no_create': True}"/>
                                <field name="current_work_order_id" options="{'no_create': True}"/>
                            </group>
                        </group>

                        <div class="oe_button_box" name="button_box">
                            <button name="action_view_work_orders" string="View Related Work Orders"
                                    type="object" class="btn-primary"
                                    attrs="{'invisible': [('current_work_order_id', '=', False)]}"/>
                        </div>
                    </page>

                    <page string="Technical Details" name="technical">
                        <group>
                            <group name="barcode_info" string="Barcode Information">
        <field name="barcode"/>
        <field name="barcode_scan_status"/>
        <field name="manual_size_override"/>
                            </group>

                            <group name="estimates" string="Weight Estimates">
        <field name="estimated_weight_per_service"/>
        <field name="weight_capacity_lbs"/>
        <field name="volume_capacity_cf"/>
                            </group>
                        </group>
                    </page>
                </notebook>
            </sheet>

            <div class="oe_chatter">
        <field name="message_ids"/>
            </div>
        </form>
    </field>
    </record>

<!-- Search View -->
    <record id="shredding_service_bin_view_search" model="ir.ui.view">
        <field name="name">shredding.service.bin.view.search</field>
        <field name="model">shredding.service.bin</field>
        <field name="arch" type="xml">
        <search string="Search Shredding Bins">
        <field name="barcode" string="Barcode" filter_domain="[('barcode', 'ilike', self)]"/>
        <field name="current_customer_id" string="Customer"/>
        <field name="location_id" string="Location"/>
        <field name="bin_size"/>

            <filter name="filter_active" string="Active" domain="[('status', '=', 'active')]"/>
            <filter name="filter_available" string="Available" domain="[('status', '=', 'available')]"/>
            <filter name="filter_maintenance" string="Maintenance" domain="[('status', '=', 'maintenance')]"/>
            <filter name="filter_deployed" string="Deployed" domain="[('current_customer_id', '!=', False)]"/>
            <filter name="filter_has_services" string="Has Services"
                    domain="[('total_services_count', '>', 0)]"/>

            <separator/>
            <filter name="filter_today" string="Serviced Today"
                    domain="[('last_service_date', '!=', False)]"/>
            <filter name="filter_week" string="This Week"
                    domain="[('last_service_date', '!=', False)]"/>

            <group expand="0" string="Group By">
                <filter name="group_by_status" string="Status" context="{'group_by': 'status'}"/>
                <filter name="group_by_size" string="Bin Size" context="{'group_by': 'bin_size'}"/>
                <filter name="group_by_customer" string="Customer" context="{'group_by': 'current_customer_id'}"/>
                <filter name="group_by_location" string="Location" context="{'group_by': 'location_id'}"/>
            </group>
        </search>
    </field>
    </record>

<!-- Kanban View -->
    <record id="shredding_service_bin_view_kanban" model="ir.ui.view">
        <field name="name">shredding.service.bin.view.kanban</field>
        <field name="model">shredding.service.bin</field>
        <field name="arch" type="xml">
        <kanban default_group_by="status" class="o_kanban_small_column">
        <field name="barcode"/>
        <field name="bin_size"/>
        <field name="status"/>
        <field name="current_customer_id"/>
        <field name="location_id"/>
        <field name="current_period_services"/>
        <field name="base_rate_per_service"/>
        <field name="last_service_date"/>

            <templates>
<t t-name="card">
                    <div class="oe_kanban_card oe_kanban_global_click">
                        <div class="oe_kanban_content">
                            <div class="oe_kanban_header">
                                <strong><field name="barcode"/></strong>
                                <span class="badge badge-pill badge-info">
        <field name="bin_size"/>
                                </span>
                            </div>

                            <div class="oe_kanban_body">
                                <div class="oe_kanban_row" t-if="record.current_customer_id.raw_value">
                                    <i class="fa fa-user"/> <field name="current_customer_id"/>
                                </div>

                                <div class="oe_kanban_row" t-if="record.location_id.raw_value">
                                    <i class="fa fa-map-marker"/> <field name="location_id"/>
                                </div>

                                <div class="oe_kanban_row">
                                    <i class="fa fa-recycle"/>
                                    Services: <field name="current_period_services"/>
                                </div>

                                <div class="oe_kanban_row" t-if="record.base_rate_per_service.raw_value > 0">
                                    <i class="fa fa-dollar"/>
        <field name="base_rate_per_service" widget="monetary"/>
                                </div>
                            </div>

                            <div class="oe_kanban_footer">
                                <div class="oe_kanban_footer_left">
        <field name="last_service_date" widget="date"/>
                                </div>
                                <div class="oe_kanban_footer_right">
                                    <button name="action_report_bin_issue" type="object"
                                            class="btn btn-sm btn-warning" title="Report Issue">
                                        <i class="fa fa-exclamation-triangle"/>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </t>
            </templates>
        </kanban>
    </field>
    </record>

<!-- ============================================================================ -->
<!-- ACTIONS -->
<!-- ============================================================================ -->

<!-- Main Shredding Service Bin Action -->
    <record id="action_shredding_service_bin" model="ir.actions.act_window">
        <field name="name">Shredding Service Bins</field>
        <field name="res_model">shredding.service.bin</field>
        <field name="view_mode">kanban,list,form</field>
        <field name="context">{
        'search_default_filter_active': 1,
    }</field>
        <field name="help" type="html">
        <p class="o_view_nocontent_smiling_face">
            No shredding service bins found!
        </p>
        <p>
            Shredding service bins are tracked containers placed at customer locations
            for secure document disposal. They include barcode tracking, service history,
            and automated billing integration.
        </p>
    </field>
    </record>

<!-- Available Bins Action -->
    <record id="action_shredding_service_bin_available" model="ir.actions.act_window">
        <field name="name">Available Bins</field>
        <field name="res_model">shredding.service.bin</field>
        <field name="view_mode">kanban,list,form</field>
        <field name="domain">[('status', '=', 'available')]</field>
        <field name="context">{}</field>
        <field name="help" type="html">
        <p class="o_view_nocontent_smiling_face">
            No available bins found!
        </p>
        <p>
            Available bins are ready for deployment to customer locations.
        </p>
    </field>
    </record>

<!-- Maintenance Bins Action -->
    <record id="action_shredding_service_bin_maintenance" model="ir.actions.act_window">
        <field name="name">Bins in Maintenance</field>
        <field name="res_model">shredding.service.bin</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('status', '=', 'maintenance')]</field>
        <field name="context">{}</field>
        <field name="help" type="html">
        <p class="o_view_nocontent_smiling_face">
            No bins in maintenance!
        </p>
        <p>
            Bins requiring maintenance, repair, or replacement will appear here.
        </p>
    </field>
    </record>
    </data>
</odoo>
