<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="document_retrieval_item_view_tree" model="ir.ui.view">
            <field name="name">document.retrieval.item.view.tree</field>
            <field name="model">document.retrieval.item</field>
            <field name="arch" type="xml">
                <list decoration-danger="priority=='3'" decoration-warning="priority=='2'" decoration-muted="status=='not_found'">
                    <field name="priority" widget="priority" optional="show" />
                    <field name="name" />
                    <field name="item_type" />
                    <field name="state" decoration-success="status=='delivered'" decoration-info="status=='retrieved'" />
                    <field name="partner_id" optional="hide" />
                    <field name="work_order_id" optional="hide" />
                    <field name="retrieval_cost" optional="show" sum="Total Cost" />
                    <field name="effective_priority" invisible="1" />
                    <field name="sequence" invisible="1" />
                </list>
            </field>
        </record>
        <record id="document_retrieval_item_view_form" model="ir.ui.view">
            <field name="name">document.retrieval.item.view.form</field>
            <field name="model">document.retrieval.item</field>
            <field name="arch" type="xml">
                <form>
                    <header>
                        <field name="priority" widget="priority" class="oe_read_only" />
                        <field name="state" widget="statusbar" statusbar_visible="pending,searching,located,retrieved,packaged,delivered" />
                        <button name="action_locate_item" string="Locate Item" type="object" class="btn-primary" invisible="status != 'pending'" />
                        <button name="action_retrieve_item" string="Retrieve Item" type="object" class="btn-primary" invisible="status != 'located'" />
                        <button name="action_package_item" string="Package Item" type="object" class="btn-primary" invisible="status != 'retrieved'" />
                    </header>
                    <sheet>
                        <div class="oe_title">
                            <h1>
                                <field name="name" placeholder="Item Reference" />
                            </h1>
                            <field name="display_name" invisible="1" />
                        </div>
                        <group>
                            <group>
                                <field name="work_order_id" />
                                <field name="partner_id" />
                                <field name="item_type" />
                                <field name="priority" widget="priority" />
                                <field name="effective_priority" readonly="1" />
                            </group>
                            <group>
                                <field name="sequence" />
                                <field name="active" />
                                <field name="company_id" />
                                <field name="user_id" />
                            </group>
                        </group>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" />
                        <field name="activity_ids" />
                        <field name="message_ids" />
                    </div>
                </form>
            </field>
        </record>
        <record id="document_retrieval_item_view_search" model="ir.ui.view">
            <field name="name">document.retrieval.item.view.search</field>
            <field name="model">document.retrieval.item</field>
            <field name="arch" type="xml">
                <search>
                    <field name="name" />
                    <field name="partner_id" />
                    <field name="work_order_id" />
                    <field name="state" />
                    <field name="priority" />
                    <separator />
                    <filter name="high_priority" string="High Priority" domain="[('priority', 'in', ['2', '3'])]" />
                    <filter name="very_high_priority" string="Very High Priority" domain="[('priority', '=', '3')]" />
                    <filter name="pending_items" string="Pending" domain="[('status', '=', 'pending')]" />
                    <filter name="active_items" string="Active Items" domain="[('status', 'in', ['pending', 'searching', 'located', 'retrieved'])]" />
                    <separator />
                    <group expand="0" string="Group By">
                        <filter name="group_priority" string="Priority" context="{'group_by': 'priority'}" />
                        <filter name="group_status" string="Status" context="{'group_by': 'status'}" />
                        <filter name="group_partner" string="Customer" context="{'group_by': 'partner_id'}" />
                        <filter name="group_work_order" string="Work Order" context="{'group_by': 'work_order_id'}" />
                    </group>
                </search>
            </field>
        </record>
        <record id="document_retrieval_item_view_kanban" model="ir.ui.view">
            <field name="name">document.retrieval.item.view.kanban</field>
            <field name="model">document.retrieval.item</field>
            <field name="arch" type="xml">
                <kanban default_group_by="status" class="o_kanban_small_column">
                    <field name="priority" />
                    <field name="name" />
                    <field name="partner_id" />
                    <field name="state" />
                    <field name="effective_priority" />
                    <templates>
                        <t t-name="card">
                            <div t-attf-class="oe_kanban_card oe_kanban_global_click #{record.priority.raw_value == '3' ? 'oe_kanban_card_danger' : record.priority.raw_value == '2' ? 'oe_kanban_card_warning' : ''}">
                                <div class="o_kanban_content">
                                    <div class="o_kanban_record_top">
                                        <div class="o_kanban_record_headings">
                                            <strong class="o_kanban_record_title">
                                                <field name="name" />
                                            </strong>
                                        </div>
                                        <div class="o_kanban_record_right">
                                            <field name="priority" widget="priority" />
                                        </div>
                                    </div>
                                    <div class="o_kanban_record_body">
                                        <field name="partner_id" />
                                    </div>
                                    <div class="o_kanban_record_bottom">
                                        <div class="oe_kanban_bottom_left">
                                            <field name="effective_priority" invisible="1" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>
        <record id="action_document_retrieval_item" model="ir.actions.act_window">
            <!-- OPTIMIZATION: Model document.retrieval.item has state field - consider using default search filters -->
            <field name="name">Document Retrieval Items</field>
            <field name="res_model">document.retrieval.item</field>
            <field name="view_mode">list,kanban,form</field>
            <field name="context">{}</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    <i class="fa fa-file-text"/> No document retrieval items yet!
                </p>
                <p>
                    <b>‚ö†Ô∏è Prerequisites:</b>
                </p>
                <ul>
                    <li>‚úì <b>Work Orders</b> - Go to: <i>Records Management &gt; Operations &gt; Document Retrieval Work Orders</i></li>
                    <li>‚úì <b>Customer Records</b> - Go to: <i>Records Management &gt; Documents</i></li>
                </ul>
                <p>
                    <b>üìã To process a retrieval item:</b>
                </p>
                <ol>
                    <li>Items auto-create when customer requests specific documents from work order</li>
                    <li>Review <b>Item Reference</b> and <b>Item Type</b> (document/box/container)</li>
                    <li>Click <b>Locate Item</b> to start warehouse search (status: pending ‚Üí searching)</li>
                    <li>Warehouse team scans barcode or manually confirms location (searching ‚Üí located)</li>
                    <li>Click <b>Retrieve Item</b> to pull from storage shelf (located ‚Üí retrieved)</li>
                    <li>Click <b>Package Item</b> to prepare for delivery (retrieved ‚Üí packaged)</li>
                    <li>Item auto-advances to <b>Delivered</b> when work order ships</li>
                    <li>Use <b>Priority Widget</b> (0-3 stars) to queue urgent retrievals first</li>
                    <li>Monitor <b>Effective Priority</b> (system-calculated ranking considering multiple factors)</li>
                </ol>
                <p>
                    <b>üìä Item States:</b>
                </p>
                <ul>
                    <li><b>Pending:</b> New retrieval request, awaiting warehouse assignment</li>
                    <li><b>Searching:</b> Warehouse team actively locating item in storage facility</li>
                    <li><b>Located:</b> Item found on shelf, position confirmed, ready for physical retrieval</li>
                    <li><b>Retrieved:</b> Item pulled from storage, in staging area, awaiting packaging</li>
                    <li><b>Packaged:</b> Item secured for transport, labeled with customer info, ready to ship</li>
                    <li><b>Delivered:</b> Item shipped to customer, chain of custody completed, order fulfilled</li>
                    <li><b>Not Found:</b> Item missing from expected location, requires investigation and customer notification</li>
                </ul>
                <p>
                    <b>üöÄ Key Features:</b><br/>
                    ‚Ä¢ <b>Priority-Based Queue:</b> High-priority items (2-3 stars) highlighted in red/yellow, processed first<br/>
                    ‚Ä¢ <b>Effective Priority Calculation:</b> System ranks items by customer SLA + request urgency + retrieval cost<br/>
                    ‚Ä¢ <b>Kanban Workflow:</b> Drag items between status columns for visual workflow management<br/>
                    ‚Ä¢ <b>Cost Tracking:</b> Each item logs retrieval labor cost, displays running total per work order<br/>
                    ‚Ä¢ <b>Sequence Control:</b> Manual sequence override for special picking order requirements<br/>
                    ‚Ä¢ <b>Multi-Item Batching:</b> Group items from same storage area for efficient picking routes<br/>
                    ‚Ä¢ <b>Not Found Handling:</b> Automatic customer notification + supervisor escalation for missing items<br/>
                    ‚Ä¢ <b>Activity Tracking:</b> Full chatter history for location updates, delays, special handling notes<br/>
                </p>
                <p>
                    <b>üí° Pro Tips:</b><br/>
                    ‚Ä¢ Sort by <b>Effective Priority</b> column to process items in optimal business order<br/>
                    ‚Ä¢ Use <b>Kanban view</b> for visual workflow management - drag cards between status columns<br/>
                    ‚Ä¢ Filter by <b>High Priority</b> or <b>Very High Priority</b> to focus on urgent retrievals first<br/>
                    ‚Ä¢ Group by <b>Work Order</b> to batch-pick all items for same customer delivery<br/>
                    ‚Ä¢ Mark items <b>Not Found</b> immediately - don\'t delay customer notification<br/>
                </p>
            </field>
        </record>
    </data>
</odoo>
