<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
<!-- ENTERPRISE VISITOR POS WIZARD - Advanced Walk-In Customer Processing &amp; Audit Integration -->

<!-- Form view for visitor.pos.wizard - Fixed for cache refresh -->
<record id="visitor_pos_wizard_view_form" model="ir.ui.view">
    <field name="name">visitor.pos.wizard.view.form</field>
        <field name="model">visitor.pos.wizard</field>
        <field name="arch" type="xml">
            <form string="Visitor POS Processing Wizard">
                <header>
<button name="action_create_pos_order" string="Create POS Order" type="object" class="btn-primary"/>
<button string="Cancel" class="btn-secondary" special="cancel"/>

                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            Visitor POS Processing
                        </h1>
                        <div class="o_row">
                            <span class="text-muted">Link visitor check-ins with POS transactions for comprehensive audit trails</span>
                        </div>
                    </div>

                    <group>
<group name="visitor_info" string="Visitor Information">
<field name="visitor_id" required="1" options="{'no_create': True}" widget="many2one"/>


                        </group>
<group name="pos_config" string="POS Configuration">
<field name="pos_config_id" required="1" options="{'no_create': True}"/>

                        </group>
                    </group>

                    <group>
<group name="customer_data" string="Customer Data Management">
<field name="partner_id" options="{'no_create': False}" widget="many2one" readonly="create_new_customer == True"/>

<field name="create_new_customer" widget="boolean_toggle"/>







</group>
<group name="service_selection" string="ðŸ›’ Service Selection">
    <field name="product_id" required="1" options="{'no_create': True}"/>






<field name="quantity" required="1"/>
<field name="unit_price" widget="monetary" readonly="1"/>


</group>
</group>
<group string="Order Summary">
    <group>
<field name="pricelist_id" readonly="1"/>
</group>
<group>
<!-- Additional summary fields can be added here as the model expands -->
</group>
</group>
</sheet>
            </form>
        </field>
</record><!-- FIXED: Corrected list view element name -->
    <record id="visitor_pos_wizard_view_tree" model="ir.ui.view">
        <field name="name">visitor.pos.wizard.view.tree</field>
        <field name="model">visitor.pos.wizard</field>
        <field name="arch" type="xml">
<list string="Visitor POS Processing History">
    <field name="visitor_id" string="Visitor"/>
    <field name="product_id" string="Product/Service"/>
    <field name="quantity" string="Quantity"/>
    <field name="unit_price" string="Unit Price" widget="monetary"/>

                <field name="pos_config_id" string="POS Terminal"/>
<field name="partner_id" string="Customer"/>
<field name="create_new_customer" string="New Customer" widget="boolean_toggle"/>

</list>
        </field>
    </record>

<!-- FIXED: Corrected POS config domain in search view -->
    <record id="visitor_pos_wizard_view_search" model="ir.ui.view">
        <field name="name">visitor.pos.wizard.view.search</field>
        <field name="model">visitor.pos.wizard</field>
        <field name="arch" type="xml">
            <search string="Search Visitor POS Processing">
<field name="visitor_id" string="Visitor"/>
<field name="pos_config_id" string="POS Terminal"/>
<field name="product_id" string="Product/Service"/>
<field name="partner_id" string="Customer"/>



<filter string="New Customer" name="new_customer" domain="[('create_new_customer', '=', True)]"/>





<group expand="0" string="Group By">
                    <filter string="POS Terminal" name="group_pos_config" context="{'group_by': 'pos_config_id'}"/>
<filter string="Product/Service" name="group_product" context="{'group_by': 'product_id'}"/>
<filter string="Customer" name="group_customer" context="{'group_by': 'partner_id'}"/>

                </group>
            </search>
        </field>
    </record>

<!-- Graph view -->
    <record id="visitor_pos_wizard_view_graph" model="ir.ui.view">
        <field name="name">visitor.pos.wizard.view.graph</field>
        <field name="model">visitor.pos.wizard</field>
        <field name="arch" type="xml">
            <graph string="Visitor POS Analytics" type="bar" sample="1">
<field name="pos_config_id" type="row"/>
<field name="product_id" type="col"/>
<field name="quantity" type="measure"/>

            </graph>
        </field>
    </record>

<!-- Pivot view -->
    <record id="visitor_pos_wizard_view_pivot" model="ir.ui.view">
        <field name="name">visitor.pos.wizard.view.pivot</field>
        <field name="model">visitor.pos.wizard</field>
        <field name="arch" type="xml">
            <pivot string="Visitor POS Performance" sample="1">
                <field name="pos_config_id" type="row"/>
<field name="product_id" type="col"/>
<field name="quantity" type="measure"/>
<field name="unit_price" type="measure"/>

            </pivot>
        </field>
    </record>

    <!-- Action corrected with proper search_view_id reference -->
    <record id="action_visitor_pos_wizard" model="ir.actions.act_window">
        <field name="name">Visitor POS Processing</field>
        <field name="res_model">visitor.pos.wizard</field>
        <field name="view_mode">list,form,graph,pivot</field>
        <field name="search_view_id" ref="visitor_pos_wizard_view_search"/>
<field name="context">{}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Process your first walk-in visitor!
            </p>
            <p>
Streamline walk-in customer processing with integrated POS transactions.
                Create POS orders directly from visitor information with automated customer linking.
            </p>
            <p>
                <strong>Key Features:</strong><br/>
                â€¢ Seamless visitor-to-customer conversion<br/>
â€¢ Integrated POS order creation<br/>
                â€¢ Automated pricing from customer pricelists<br/>
                â€¢ Simple product/service selection
            </p>
        </field>
    </record>

<!-- Action wizard -->
    <record id="action_visitor_pos_processing_wizard" model="ir.actions.act_window">
        <field name="name">Process Walk-In Visitor</field>
        <field name="res_model">visitor.pos.wizard</field>
        <field name="view_mode">form</field>
<field name="view_id" ref="visitor_pos_wizard_view_form"/>


        <field name="target">new</field>
<field name="context">{}</field>
    </record>
</data>
</odoo>
