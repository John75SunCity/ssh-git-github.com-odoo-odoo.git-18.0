<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- Action must be defined BEFORE views that reference it -->
        <record id="action_container_destruction_work_order" model="ir.actions.act_window">
            <!-- OPTIMIZATION: Model container.destruction.work.order has state field - consider using default search filters -->
            <field name="name">Container Destruction Work Orders</field>
            <field name="res_model">container.destruction.work.order</field>
            <field name="view_mode">list,form</field>
            <field name="domain">[]</field>
            <field name="context">{}</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    <i class="fa fa-trash"/> No container destruction work orders yet!
                </p>
                <p>
                    <b>‚ö†Ô∏è Prerequisites:</b>
                </p>
                <ul>
                    <li>‚úì <b>Retention Policy Compliance</b> - Go to: <i>Records Management &gt; Retention Policies</i></li>
                    <li>‚úì <b>Customer Authorization</b> - Go to: <i>Portal &gt; Destruction Requests</i></li>
                    <li>‚úì <b>NAID Certification Active</b> - Go to: <i>Compliance &gt; NAID Settings</i></li>
                    <li>‚úì <b>Destruction Equipment Ready</b> - Go to: <i>Configuration &gt; Shredding Equipment</i></li>
                </ul>
                <p>
                    <b>üìã To execute container destruction:</b>
                </p>
                <ol>
                    <li>Ensure <b>retention period expired</b> or customer provided <b>written authorization</b></li>
                    <li>Click "Create" and select <b>Customer/Partner</b></li>
                    <li>Add <b>Container(s)</b> approved for destruction</li>
                    <li>Set <b>Destruction Date</b> and <b>Method</b> (shredding/pulping/incineration)</li>
                    <li>Assign <b>Destruction Coordinator</b> and <b>Equipment Operator</b></li>
                    <li>Select <b>NAID Compliance Level</b> (AAA/AA/A) based on document sensitivity</li>
                    <li>Enable <b>Witness Required</b> if customer wants to observe destruction</li>
                    <li>Add <b>Witness Information</b> (name, company, contact) if applicable</li>
                    <li>Click <b>Confirm</b> to schedule destruction and lock container contents</li>
                    <li>Pull containers from storage to destruction area before scheduled time</li>
                    <li>Click <b>Start Destruction</b> when equipment ready and witnesses present</li>
                    <li>Destroy containers following NAID procedures (particle size compliance)</li>
                    <li>Log <b>Destruction Method</b> details, equipment used, particle size verification</li>
                    <li>Capture <b>Witness Signatures</b> (customer witness + staff witness + operator)</li>
                    <li>Record <b>Weight of Destroyed Material</b> for environmental reporting</li>
                    <li>Click <b>Complete</b> - system auto-generates <b>Certificate of Destruction</b></li>
                    <li>System sends certificate PDF to customer email automatically</li>
                    <li>Enable <b>Portal Visible</b> so customer can download certificate from portal</li>
                </ol>
                <p>
                    <b>üìä Destruction States:</b>
                </p>
                <ul>
                    <li><b>Pending Authorization:</b> Awaiting customer approval or retention policy expiration</li>
                    <li><b>Scheduled:</b> Customer approved, destruction date set, resources assigned</li>
                    <li><b>Prepared:</b> Containers pulled to destruction area, equipment ready, witnesses notified</li>
                    <li><b>In Progress:</b> Active destruction underway, NAID procedures being followed</li>
                    <li><b>Completed:</b> Destruction finished, certificate issued, containers permanently removed from inventory</li>
                    <li><b>Cancelled:</b> Customer withdrawal, legal hold imposed, destruction authorization revoked</li>
                </ul>
                <p>
                    <b>üöÄ Key Features:</b><br/>
                    ‚Ä¢ <b>NAID AAA Compliance:</b> Meets highest industry standard for secure document destruction<br/>
                    ‚Ä¢ <b>Triple Witness System:</b> Customer witness + Staff witness + Equipment operator signatures<br/>
                    ‚Ä¢ <b>Auto-Certificate Generation:</b> Professional PDF with NAID logo, company seal, all required fields<br/>
                    ‚Ä¢ <b>Retention Policy Enforcement:</b> Only allows destruction after retention period expires<br/>
                    ‚Ä¢ <b>Legal Hold Protection:</b> Blocks destruction of containers under litigation hold<br/>
                    ‚Ä¢ <b>Environmental Tracking:</b> Log weight destroyed for recycling/sustainability reports<br/>
                    ‚Ä¢ <b>Portal Integration:</b> Customers can request destruction and download certificates online<br/>
                    ‚Ä¢ <b>Particle Size Verification:</b> Ensure shredded material meets NAID particle size standards<br/>
                    ‚Ä¢ <b>Audit Trail:</b> Immutable log from authorization through destruction to certificate delivery<br/>
                </p>
                <p>
                    <b>üí° Pro Tips:</b><br/>
                    ‚Ä¢ Verify <b>no legal holds</b> on containers before destruction - check retention policy status<br/>
                    ‚Ä¢ Use <b>Portal Visible</b> to let customers track destruction status and download certificates<br/>
                    ‚Ä¢ <b>NAID AAA</b> requires witness signatures - ensure witnesses present before starting<br/>
                    ‚Ä¢ <b>Photograph particle size</b> for extra compliance documentation (attach to work order)<br/>
                    ‚Ä¢ Always send <b>certificate within 24 hours</b> of destruction for customer satisfaction<br/>
                    ‚Ä¢ Record <b>environmental metrics</b> (recycled weight) for corporate sustainability reporting<br/>
                </p>
            </field>
        </record>

        <record id="container_destruction_work_order_view_tree" model="ir.ui.view">
            <field name="name">container.destruction.work.order.view.tree</field>
            <field name="model">container.destruction.work.order</field>
            <field name="arch" type="xml">
                <list>
                    <field name="name" />
                    <field name="portal_visible" widget="boolean_toggle" optional="show"/>
                </list>
            </field>
        </record>
        <record id="container_destruction_work_order_view_form" model="ir.ui.view">
            <field name="name">container.destruction.work.order.view.form</field>
            <field name="model">container.destruction.work.order</field>
            <field name="arch" type="xml">
                <form string="Container Destruction Work Order">
                    <header>
                        <button name="action_confirm" string="Confirm" type="object" 
                                invisible="state != 'draft'" class="oe_highlight"/>
                        <button name="action_authorize" string="Authorize" type="object" 
                                invisible="state != 'confirmed'" class="oe_highlight"/>
                        <button name="action_schedule" string="Schedule" type="object" 
                                invisible="state != 'authorized'" class="oe_highlight"/>
                        <button name="action_start_destruction" string="Start Destruction" type="object" 
                                invisible="state not in ['scheduled']" class="oe_highlight"/>
                        <button name="action_mark_all_destroyed" string="üì¶ Mark All as Destroyed" type="object" 
                                invisible="state not in ['in_progress', 'scheduled']" 
                                class="btn-danger"
                                confirm="This will mark ALL containers as destroyed and make them billable. Continue?"/>
                        <button name="action_generate_certificate" string="Generate Certificate" type="object" 
                                invisible="state != 'destroyed'" class="oe_highlight"/>
                        <button name="action_cancel" string="Cancel" type="object" 
                                invisible="state in ['completed', 'cancelled']"/>
                        <field name="state" widget="statusbar" 
                               statusbar_visible="draft,confirmed,authorized,scheduled,in_progress,destroyed,certified,completed"/>
                    </header>
                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <button name="%(action_container_destruction_work_order)d" 
                                    type="action" 
                                    class="oe_stat_button" 
                                    icon="fa-file-text-o">
                                <field name="container_count" widget="statinfo" string="Containers"/>
                            </button>
                        </div>
                        <div class="oe_title">
                            <label for="name"/>
                            <h1>
                                <field name="name" placeholder="Work Order Reference..."/>
                            </h1>
                        </div>
                        <group>
                            <group string="Customer Information">
                                <field name="partner_id"/>
                                <field name="portal_request_id"/>
                                <field name="user_id"/>
                            </group>
                            <group string="Status &amp; Visibility">
                                <field name="portal_visible" widget="boolean_toggle"/>
                                <field name="priority" widget="priority"/>
                                <field name="active" invisible="1"/>
                            </group>
                        </group>
                        <group string="Destruction Details">
                            <group>
                                <field name="scheduled_destruction_date"/>
                                <field name="actual_destruction_date"/>
                                <field name="destruction_method"/>
                            </group>
                            <group>
                                <field name="customer_authorized"/>
                                <field name="customer_authorization_date"/>
                                <field name="authorized_by"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Containers" name="containers">
                                <field name="container_ids" widget="many2many_tags"/>
                            </page>
                            <page string="Authorization" name="authorization">
                                <group>
                                    <field name="destruction_reason"/>
                                    <field name="authorization_document" filename="authorization_filename"/>
                                </group>
                            </page>
                            <page string="Certificate" name="certificate" invisible="state not in ['certified', 'completed']">
                                <group>
                                    <field name="certificate_id"/>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids"/>
                        <field name="activity_ids"/>
                        <field name="message_ids"/>
                    </div>
                </form>
            </field>
        </record>
        <record id="container_destruction_work_order_view_search" model="ir.ui.view">
            <field name="name">container.destruction.work.order.view.search</field>
            <field name="model">container.destruction.work.order</field>
            <field name="arch" type="xml">
                <search>
                    <group expand="1" string="Group By">
                        <filter string="Name" name="name" domain="[]" context="{'group_by':'name'}" />
                    </group>
                </search>
            </field>
        </record>
    </data>
</odoo>
