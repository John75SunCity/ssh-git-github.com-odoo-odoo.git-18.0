<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
    
        <record id="bin_barcode_inventory_view_form" model="ir.ui.view">
            <field name="name">bin.barcode.inventory.view.form</field>
            <field name="model">bin.barcode.inventory</field>
            <field name="arch" type="xml">
                <form string="Bin Barcode Inventory">
                    <header>
                        <button name="action_set_available" type="object" string="Set Available" class="oe_highlight" invisible="state == 'available'" />
                        <button name="action_set_full" type="object" string="Mark Full" class="btn-warning" invisible="state in ['full', 'retired']" />
                        <button name="action_service_complete" type="object" string="Service Complete" class="btn-success" invisible="state != 'full'" />
                        <button name="action_print_barcode_label" type="object" string="Print Label" class="btn-secondary" />
                        <field name="state" widget="statusbar" statusbar_visible="available,in_use,full,maintenance" />
                    </header>
                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <button name="update_sequences_from_import" type="object" string="Update Sequences" class="oe_stat_button" icon="fa-refresh" groups="records_management.group_records_manager" help="Update all sequences based on imported bins" />
                        </div>
                        <div class="oe_title">
                            <h1>
                                <field name="name" readonly="1" />
                            </h1>
                        </div>
                        <group>
                            <group name="identification">
                                <field name="barcode" required="1" />
                                <field name="bin_size" required="1" />
                                <field name="bin_type" readonly="1" />
                                <field name="state" />
                                <field name="active" />
                            </group>
                            <group name="capacity">
                                <field name="capacity_pounds" readonly="1" />
                                <field name="current_weight" />
                                <field name="fill_percentage" readonly="1" widget="percentage" />
                                <field name="fill_level" />
                                <field name="estimated_weight_lbs" readonly="1" />
                                <field name="location" />
                            </group>
                        </group>
                        <group>
                            <group name="assignment">
                                <field name="customer_id" />
                                <field name="service_route" />
                            </group>
                            <group name="tracking">
                                <field name="date_created" readonly="1" />
                                <field name="last_service_date" readonly="1" />
                                <field name="next_service_date" />
                            </group>
                        </group>
                        <group>
                            <group name="flags">
                                <field name="is_imported" readonly="1" />
                                <field name="is_generated" readonly="1" />
                            </group>
                        </group>
                        <notebook>
                            <page string="Notes" name="notes">
                                <field name="notes" placeholder="Additional notes about this bin..." />
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" />
                        <field name="activity_ids" />
                        <field name="message_ids" />
                    </div>
                </form>
            </field>
        </record>
        <record id="bin_barcode_inventory_view_tree" model="ir.ui.view">
            <field name="name">bin.barcode.inventory.view.tree</field>
            <field name="model">bin.barcode.inventory</field>
            <field name="arch" type="xml">
                <list string="Bin Barcode Inventory" decoration-success="state == 'available'" decoration-warning="state == 'in_use'" decoration-danger="state == 'full'" decoration-muted="state == 'retired'">
                    <field name="barcode" />
                    <field name="bin_size" />
                    <field name="bin_type" />
                    <field name="state" widget="badge" decoration-success="state == 'available'" decoration-warning="state == 'in_use'" decoration-danger="state == 'full'" />
                    <field name="customer_id" />
                    <field name="technician_id" />
                    <field name="vehicle_id" />
                    <field name="fsm_task_id" />
                    <field name="location" />
                    <field name="capacity_pounds" />
                    <field name="current_weight" />
                    <field name="fill_level" />
                    <field name="fill_percentage" widget="percentage" />
                    <field name="estimated_weight_lbs" />
                    <field name="last_service_date" />
                    <field name="is_imported" widget="boolean_toggle" />
                    <field name="is_generated" widget="boolean_toggle" />
                </list>
            </field>
        </record>
        <record id="bin_barcode_inventory_view_kanban" model="ir.ui.view">
            <field name="name">bin.barcode.inventory.view.kanban</field>
            <field name="model">bin.barcode.inventory</field>
            <field name="arch" type="xml">
                <kanban default_group_by="state" class="o_kanban_small_column">
                    <field name="id" />
                    <field name="barcode" />
                    <field name="bin_size" />
                    <field name="state" />
                    <field name="customer_id" />
                    <field name="location" />
                    <field name="fill_percentage" />
                    <field name="capacity_pounds" />
                    <field name="current_weight" />
                    <field name="estimated_weight_lbs" />
                    <field name="fill_level" />
                    <templates>
                        <t t-name="card">
                            <div class="o_kanban_record o_kanban_global_click o_rm_bin_card">
                                <div class="o_kanban_primary_bottom">
                                    <div class="d-flex justify-content-between align-items-start mb-1">
                                        <div>
                                            <strong class="o_rm_bin_barcode">
                                                <field name="barcode" />
                                            </strong>
                                            <span class="text-muted small ms-2">
                                                <field name="bin_size" />
                                            </span>
                                        </div>
                                        <div class="text-end">
                                            <span t-if="record.is_imported.raw_value" class="badge bg-info me-1">Imported</span>
                                            <span t-if="record.is_generated.raw_value" class="badge bg-success">Generated</span>
                                        </div>
                                    </div>
                                    <div class="o_rm_bin_meta small mb-2">
                                        <span t-if="record.customer_id.raw_value" class="me-3">
                                            <i class="fa fa-user" title="Customer" aria-label="Customer" />
                                            <field name="customer_id" />
                                        </span>
                                        <span t-if="record.location.raw_value">
                                            <i class="fa fa-map-marker" title="Location" aria-label="Location" />
                                            <field name="location" />
                                        </span>
                                    </div>
                                    <div class="o_rm_bin_progress">
                                        <div class="progress" style="height:6px;">
                                            <div class="progress-bar" role="progressbar" t-attf-style="width: #{record.fill_percentage.raw_value}%" t-attf-class="progress-bar #{record.fill_percentage.raw_value &gt; 80 and 'bg-danger' or record.fill_percentage.raw_value &gt; 60 and 'bg-warning' or 'bg-success'}">
    </div>
                                        </div>
                                        <small class="text-muted">
                                            <field name="current_weight" />
/        <field name="capacity_pounds" />
lbs
</small>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>
        <record id="bin_barcode_inventory_view_search" model="ir.ui.view">
            <field name="name">bin.barcode.inventory.view.search</field>
            <field name="model">bin.barcode.inventory</field>
            <field name="arch" type="xml">
                <search string="Bin Barcode Inventory">
                    <field name="barcode" string="Barcode" />
                    <field name="customer_id" string="Customer" />
                    <field name="location" string="Location" />
                    <field name="bin_size" string="Bin Size" />
                    <field name="technician_id" string="Technician" />
                    <field name="vehicle_id" string="Vehicle" />
                    <field name="fill_level" string="Fill Level" />
                    <filter string="Available" name="available" domain="[('state', '=', 'available')]" />
                    <filter string="In Use" name="in_use" domain="[('state', '=', 'in_use')]" />
                    <filter string="Full" name="full" domain="[('state', '=', 'full')]" />
                    <filter string="Maintenance" name="maintenance" domain="[('state', '=', 'maintenance')]" />
                    <separator />
                    <filter string="23 Gallon" name="size_23" domain="[('bin_size', '=', '23_gallon')]" />
                    <filter string="32 Gallon" name="size_32" domain="[('bin_size', '=', '32_gallon')]" />
                    <filter string="32 Console" name="size_32c" domain="[('bin_size', '=', '32_console')]" />
                    <filter string="64 Gallon" name="size_64" domain="[('bin_size', '=', '64_gallon')]" />
                    <filter string="96 Gallon" name="size_96" domain="[('bin_size', '=', '96_gallon')]" />
                    <separator />
                    <filter string="Imported Bins" name="imported" domain="[('is_imported', '=', True)]" />
                    <filter string="Generated Bins" name="generated" domain="[('is_generated', '=', True)]" />
                    <filter string="Needs Service" name="needs_service" domain="[('state', '=', 'full')]" />
                    <separator />
                    <filter string="Archived" name="inactive" domain="[('active', '=', False)]" />
                    <group expand="0" string="Group By">
                        <filter string="Status" name="group_state" context="{'group_by': 'state'}" />
                        <filter string="Bin Size" name="group_size" context="{'group_by': 'bin_size'}" />
                        <filter string="Bin Type" name="group_type" context="{'group_by': 'bin_type'}" />
                        <filter string="Customer" name="group_customer" context="{'group_by': 'customer_id'}" />
                        <filter string="Location" name="group_location" context="{'group_by': 'location'}" />
                        <filter string="Service Route" name="group_route" context="{'group_by': 'service_route'}" />
                    </group>
                </search>
            </field>
        </record>
        <record id="action_bin_barcode_inventory" model="ir.actions.act_window">
            <!-- OPTIMIZATION: Model bin.barcode.inventory has state field - consider using default search filters -->
            <field name="name">Bin Barcode Inventory</field>
            <field name="res_model">bin.barcode.inventory</field>
            <field name="view_mode">list,form,graph,pivot</field>
            <field name="context">{
            'search_default_available': 1,
        }</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    <i class="fa fa-trash"/> No shredding bins tracked yet!
                </p>
                <p>
                    <b>‚ö†Ô∏è Prerequisites:</b>
                </p>
                <ul>
                    <li>‚úì <b>Bin Sizes Configured</b> - Go to: <i>Configuration &gt; Barcode Management &gt; Barcode Products</i></li>
                    <li>‚úì <b>Service Routes Defined</b> - Go to: <i>Field Service &gt; Configuration &gt; Service Routes</i></li>
                    <li>‚úì <b>Customers Active</b> - Go to: <i>Contacts</i> (customers with shredding services)</li>
                    <li>‚úì <b>Barcode Labels Printed</b> - Physical labels affixed to bins (QR code + bin number)</li>
                </ul>
                <p>
                    <b>üìã Bin Lifecycle Management:</b>
                </p>
                <ol>
                    <li><b>Initial Bin Creation:</b></li>
                    <li>Click <b>Create</b> to add new bin to inventory</li>
                    <li>System auto-assigns <b>Barcode</b> (e.g., BIN-23G-00001 for 23-gallon bin #1)</li>
                    <li>Select <b>Bin Size</b>: 23G, 32G, 32C (console), 64G, 96G gallons</li>
                    <li>System auto-sets <b>Capacity (lbs)</b>: 23G=50lbs, 32G=70lbs, 64G=140lbs, 96G=200lbs</li>
                    <li>Print <b>Barcode Label</b> and affix to physical bin</li>
                    <li>Bin status: <b>Available</b> (ready for customer deployment)</li>
                    <li><b>Customer Deployment:</b></li>
                    <li>Assign <b>Customer</b> when bin delivered to client site</li>
                    <li>Set <b>Location</b> (customer address or internal location code)</li>
                    <li>Assign to <b>Service Route</b> for regular pickup scheduling</li>
                    <li>Set <b>Next Service Date</b> (when bin scheduled for pickup/exchange)</li>
                    <li>Bin status changes to <b>In Use</b></li>
                    <li><b>Fill Level Tracking:</b></li>
                    <li>Driver updates <b>Fill Level</b> during route visits: Empty, 25%, 50%, 75%, Full</li>
                    <li>System estimates <b>Current Weight</b> based on fill % √ó capacity</li>
                    <li><b>Fill Percentage</b> auto-calculates (visual progress bar in Kanban)</li>
                    <li>When fill &gt;80%, system flags for <b>priority pickup</b></li>
                    <li><b>Full Bin Service:</b></li>
                    <li>Driver marks <b>Set Full</b> when bin ready for pickup</li>
                    <li>Bin status: <b>Full</b> (needs service)</li>
                    <li>System creates FSM task for shredding/exchange</li>
                    <li>Driver picks up full bin, delivers empty replacement</li>
                    <li>Log <b>Last Service Date</b>, calculate <b>Next Service Date</b> (30/60/90 days)</li>
                    <li>Full bin returns to facility for shredding</li>
                    <li>Click <b>Service Complete</b> after shredding</li>
                    <li>Bin status returns to <b>Available</b> (ready for redeployment)</li>
                    <li><b>Maintenance &amp; Retirement:</b></li>
                    <li>Mark <b>Maintenance</b> if bin damaged (removed from service)</li>
                    <li>After repair, click <b>Set Available</b></li>
                    <li>For permanent damage, archive bin (Active = False)</li>
                    <li>Retired bins move to <b>Archived</b> filter</li>
                </ol>
                <p>
                    <b>üìä Bin States &amp; Workflow:</b>
                </p>
                <ul>
                    <li><b>Available:</b> At facility, ready for customer deployment</li>
                    <li><b>In Use:</b> Deployed at customer site, collecting documents</li>
                    <li><b>Full:</b> Needs pickup, scheduled for shredding service</li>
                    <li><b>Maintenance:</b> Damaged/broken, removed from service for repair</li>
                    <li><b>Retired:</b> Archived (permanently removed from circulation)</li>
                </ul>
                <p>
                    <b>üöÄ Key Features:</b><br/>
                    ‚Ä¢ <b>Auto-Barcode Generation:</b> Sequential numbering by size (BIN-23G-00001, BIN-32G-00001)<br/>
                    ‚Ä¢ <b>Capacity Tracking:</b> Weight limits pre-configured, fill percentage auto-calculated<br/>
                    ‚Ä¢ <b>Kanban Workflow:</b> Visual pipeline (Available ‚Üí In Use ‚Üí Full ‚Üí Available)<br/>
                    ‚Ä¢ <b>Route Integration:</b> Links to service routes for automated scheduling<br/>
                    ‚Ä¢ <b>FSM Task Creation:</b> Auto-generate pickup tasks when bin marked full<br/>
                    ‚Ä¢ <b>Mobile Scanning:</b> Drivers scan QR codes to update bin status in field<br/>
                    ‚Ä¢ <b>Analytics Dashboards:</b> Route load pivot, fill % graphs, utilization reports<br/>
                    ‚Ä¢ <b>Import/Generation Flags:</b> Track which bins imported vs newly generated<br/>
                </p>
                <p>
                    <b>üí° Pro Tips:</b><br/>
                    ‚Ä¢ Use <b>Full filter</b> daily to prioritize pickup scheduling<br/>
                    ‚Ä¢ Review <b>Route Dashboard</b> to balance route loads (total weight per route)<br/>
                    ‚Ä¢ <b>Kanban view</b> grouped by state shows visual pipeline for bin circulation<br/>
                    ‚Ä¢ <b>Group by Customer</b> to see all bins deployed at each client site<br/>
                    ‚Ä¢ Filter by <b>Bin Size</b> to optimize truck loads (mix 23G + 64G for capacity)<br/>
                    ‚Ä¢ <b>Next Service Date</b> filter shows bins due for pickup this week<br/>
                </p>
            </field>
        </record>
        <record id="bin_barcode_inventory_view_pivot" model="ir.ui.view">
            <field name="name">bin.barcode.inventory.view.pivot</field>
            <field name="model">bin.barcode.inventory</field>
            <field name="arch" type="xml">
                <pivot string="Bin Weights (Estimated)" disable_linking="True">
                    <field name="service_route" type="row" />
                    <field name="technician_id" type="col" />
                    <field name="estimated_weight_lbs" type="measure" sum="True" />
                    <field name="fill_percentage" type="measure" avg="True" />
                </pivot>
            </field>
        </record>
        <record id="bin_barcode_inventory_view_graph" model="ir.ui.view">
            <field name="name">bin.barcode.inventory.view.graph</field>
            <field name="model">bin.barcode.inventory</field>
            <field name="arch" type="xml">
                <graph string="Route Load" type="bar">
                    <field name="service_route" type="row" />
                    <field name="estimated_weight_lbs" type="measure" />
                </graph>
            </field>
        </record>
        <record id="action_bin_route_dashboard" model="ir.actions.act_window">
            <!-- OPTIMIZATION: Model bin.barcode.inventory has state field - consider using default search filters -->
            <field name="name">Route Load Dashboard</field>
            <field name="res_model">bin.barcode.inventory</field>
            <field name="view_mode">pivot,graph</field>
            <field name="context">{
            'search_default_group_route': 1,
        }</field>
        </record>
        <record id="shredding_bin_sequence_reset_wizard_view_form" model="ir.ui.view">
            <field name="name">shredding.bin.sequence.reset.wizard.view.form</field>
            <field name="model">shredding.bin.sequence.reset.wizard</field>
            <field name="arch" type="xml">
                <form string="Reset Bin Sequence">
                    <div class="alert alert-warning" role="alert">
                        <strong>Warning:</strong> This action will reset the sequence number for new bin barcodes.
                    This should only be done by administrators for specific reasons like misprints or reorganization.
                </div>
                    <group>
                        <group>
                            <field name="bin_size" required="1" />
                            <field name="current_sequence_number" readonly="1" />
                        </group>
                        <group>
                            <field name="new_sequence_number" required="1" />
                        </group>
                    </group>
                    <group>
                        <field name="reset_reason" required="1" placeholder="Please provide a detailed reason for resetting the sequence..." />
                    </group>
                    <footer>
                        <button name="action_reset_sequence" type="object" string="Reset Sequence" class="btn-primary" />
                        <button string="Cancel" class="btn-secondary" special="cancel" />
                    </footer>
                </form>
            </field>
        </record>
        <record id="action_shredding_bin_sequence_reset_wizard" model="ir.actions.act_window">
            <field name="name">Reset Bin Sequence</field>
            <field name="res_model">shredding.bin.sequence.reset.wizard</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
        </record>
    
        <menuitem id="menu_bin_barcode_inventory_root" name="Bin Inventory" parent="menu_records_operations" sequence="30" groups="records_management.group_records_user" />
        <menuitem id="menu_bin_barcode_inventory" name="Bin Barcode Inventory" parent="menu_bin_barcode_inventory_root" action="action_bin_barcode_inventory" sequence="10" />
        <menuitem id="menu_bin_sequence_reset" name="Reset Bin Sequences" parent="menu_bin_barcode_inventory_root" action="action_shredding_bin_sequence_reset_wizard" groups="records_management.group_records_manager" sequence="20" />
        <menuitem id="menu_bin_route_dashboard" name="Route Dashboard" parent="menu_bin_barcode_inventory_root" action="action_bin_route_dashboard" sequence="40" />
    
    
    </data>
</odoo>
