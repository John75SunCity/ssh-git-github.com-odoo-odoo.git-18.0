<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="naid_compliance_view_kanban" model="ir.ui.view">
            <field name="name">naid.compliance.view.kanban</field>
            <field name="model">naid.compliance</field>
            <field name="arch" type="xml">
                <kanban default_group_by="compliance_status" class="o_kanban_naid_dashboard">
                    <field name="name" />
                    <field name="naid_level" />
                    <field name="compliance_status" />
                    <field name="certification_date" />
                    <field name="expiry_date" />
                    <field name="audit_required" />
                    <field name="certificate_valid" />
                    <templates>
                        <t t-name="card">
                            <div class="oe_kanban_card oe_kanban_global_click">
                                <div class="o_kanban_card_header">
                                    <div class="o_kanban_card_header_title">
                                        <div class="o_primary">
                                            <strong>
                                                <i class="fa fa-trophy" title="NAID Compliance" />
                                                <field name="name" />
                                            </strong>
                                        </div>
                                        <div class="o_secondary">
                                            <i class="fa fa-certificate" aria-hidden="true" title="Certificate" /> NAID <field name="naid_level" />
                                        </div>
                                    </div>
                                    <div class="o_kanban_manage_button_section">
                                        <a class="o_kanban_manage_toggle_button" href="#">
                                            <i class="fa fa-ellipsis-v" role="img" aria-label="More options" title="More options" />
                                        </a>
                                    </div>
                                </div>
                                <div class="o_kanban_card_content" t-att-title="record.display_name.raw_value" t-att-aria-label="record.display_name.raw_value" role="group">
                                    <div class="row">
                                        <div class="col-8">
                                            <div>
                                                <i class="fa fa-calendar" aria-hidden="true" title="Certification date" />
                                            Certified: <field name="certification_date" />
                                            </div>
                                            <div>
                                                <i class="fa fa-clock-o" aria-hidden="true" title="Expiry date" />
                                            Expires: <field name="expiry_date" />
                                            </div>
                                        </div>
                                        <div class="col-4">
                                            <span class="badge" t-att-class="record.certificate_valid.raw_value ? 'badge-success' : 'badge-danger'">
                                                <t t-if="record.certificate_valid.raw_value">
                                                    <i class="fa fa-check-circle text-success" title="Valid" /> Valid</t>
                                                <t t-else="">
                                                    <i class="fa fa-times-circle text-danger" title="Invalid" /> Invalid</t>
                                            </span>
                                            <span class="badge badge-warning" t-if="record.audit_required.raw_value">
                                            Audit Due
                                        </span>
                                        </div>
                                    </div>
                                    <div class="row mt-2">
                                        <div class="col-6">
                                            <button class="btn btn-primary btn-sm" type="object" name="action_conduct_audit">
                                            Audit
                                        </button>
                                        </div>
                                        <div class="col-6">
                                            <button class="btn btn-success btn-sm" type="object" name="action_renew_certificate">
                                            Renew
                                        </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="o_kanban_card_manage_pane dropdown-menu" role="menu">
                                    <a role="menuitem" type="edit" class="dropdown-item">
                                        <i class="fa fa-edit" title="Edit" /> Edit Compliance</a>
                                    <a role="menuitem" type="object" name="action_view_audit_history" class="dropdown-item">
                                        <i class="fa fa-clipboard" title="Audit History" /> Audit History</a>
                                    <a role="menuitem" type="object" name="action_generate_certificate" class="dropdown-item">
                                        <i class="fa fa-certificate" title="Generate Certificate" /> Generate Certificate</a>
                                    <a role="menuitem" type="object" name="action_compliance_report" class="dropdown-item">
                                        <i class="fa fa-bar-chart" title="Compliance Report" /> Compliance Report</a>
                                    <div class="dropdown-divider" />
                                    <a role="menuitem" type="object" name="action_schedule_audit" class="dropdown-item">
                                        <i class="fa fa-calendar" title="Schedule Audit" /> Schedule Audit</a>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>
        <record id="naid_compliance_view_tree" model="ir.ui.view">
            <field name="name">naid.compliance.view.tree</field>
            <field name="model">naid.compliance</field>
            <field name="arch" type="xml">
                <list decoration-success="compliance_status == 'certified' and certificate_valid == True" decoration-warning="compliance_status == 'pending_audit'" decoration-danger="certificate_valid == False or expiry_date &lt; context_today" decoration-info="naid_level == 'AAA'">
                    <field name="name" string="Compliance Record" />
                    <field name="facility_name" string="Facility" />
                    <field name="naid_level" string="NAID Level" widget="badge" />
                    <field name="compliance_status" string="Status" widget="badge" />
                    <field name="certification_date" string="Certified" />
                    <field name="expiry_date" string="Expires" />
                    <field name="certificate_valid" string="Valid" widget="boolean_toggle" />
                    <field name="audit_required" string="Audit Due" widget="boolean_toggle" />
                    <field name="last_audit_date" string="Last Audit" />
                    <button name="action_conduct_audit" type="object" string="Audit" icon="fa-search" class="btn-link" invisible="not audit_required" />
                    <button name="action_renew_certificate" type="object" string="Renew" icon="fa-refresh" class="btn-link" />
                </list>
            </field>
        </record>
        <record id="naid_compliance_view_form" model="ir.ui.view">
            <field name="name">naid.compliance.view.form</field>
            <field name="model">naid.compliance</field>
            <field name="arch" type="xml">
                <form>
                    <header>
                        <button name="action_conduct_audit" type="object" string="Conduct Audit" class="btn-primary" invisible="not audit_required" />
                        <button name="action_generate_certificate" type="object" string="Generate Certificate" class="btn-secondary" />
                        <button name="action_renew_certificate" type="object" string="Renew Certificate" class="btn-info" />
                        <button name="action_compliance_report" type="object" string="Compliance Report" class="btn-success" />
                        <field name="compliance_status" widget="statusbar" statusbar_visible="draft,pending_audit,certified,non_compliant,expired" />
                    </header>
                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <button class="oe_stat_button" type="object" name="action_view_audit_history" icon="fa-history">
                                <field name="audit_count" string="Audit History" widget="statinfo" />
                            </button>
                            <button class="oe_stat_button" type="object" name="action_view_certificates" icon="fa-certificate">
                                <field name="certificate_count" string="Certificates" widget="statinfo" />
                            </button>
                            <button class="oe_stat_button" type="object" name="action_view_destruction_records" icon="fa-shredder">
                                <field name="destruction_count" string="Destructions" widget="statinfo" />
                            </button>
                            <button class="oe_stat_button" icon="fa-shield" invisible="naid_level != 'AAA'">
                                <div class="o_field_widget o_stat_info">
                                    <span class="o_stat_value">
                                        <i class="fa fa-trophy" title="NAID Trophy" />
                                    </span>
                                    <span class="o_stat_text">NAID AAA</span>
                                </div>
                            </button>
                        </div>
                        <group>
                            <group string="NAID Certification">
                                <field name="name" placeholder="e.g., NAID-2024-AAA-001" />
                                <field name="naid_level" />
                                <field name="naid_member_id" />
                                <field name="facility_name" />
                            </group>
                            <group string="Certification Timeline">
                                <field name="certification_date" />
                                <field name="expiry_date" />
                                <field name="certificate_valid" />
                                <field name="auto_renewal" />
                            </group>
                        </group>
                        <group>
                            <group string="Audit Requirements">
                                <field name="audit_required" />
                                <field name="last_audit_date" />
                                <field name="next_audit_date" />
                                <field name="audit_frequency" />
                            </group>
                            <group string="Compliance Team">
                                <field name="compliance_officer" />
                                <field name="facility_manager" />
                                <field name="security_officer" />
                                <field name="third_party_auditor" />
                            </group>
                        </group>
                        <notebook>
                            <page string="NAID Standards" name="standards">
                                <group>
                                    <group string="Physical Security">
                                        <field name="physical_security_score" />
                                        <field name="access_control_verified" />
                                        <field name="surveillance_system" />
                                        <field name="secure_storage" />
                                    </group>
                                    <group string="Personnel Security">
                                        <field name="personnel_screening" />
                                        <field name="background_checks" />
                                        <field name="training_completed" />
                                        <field name="security_clearance" />
                                    </group>
                                </group>
                                <group>
                                    <group string="Information Security">
                                        <field name="information_handling" />
                                        <field name="chain_of_custody" />
                                        <field name="destruction_verification" />
                                        <field name="certificate_tracking" />
                                    </group>
                                    <group string="Operational Security">
                                        <field name="equipment_certification" />
                                        <field name="process_verification" />
                                        <field name="quality_control" />
                                        <field name="incident_management" />
                                    </group>
                                </group>
                            </page>
                            <page string="Audit History" name="audits">
                                <field name="audit_history_ids" mode="list">
                                    <list>
                                        <field name="event_date" />
                                        <field name="user_id" />
                                        <field name="action_type" />
                                        <field name="description" />
                                        <field name="res_model" />
                                        <field name="res_name" />
                                    </list>
                                </field>
                            </page>
                            <page string="Certificates" name="certificates">
                                <field name="certificate_ids" mode="list">
                                    <list>
                                        <field name="certificate_number" />
                                        <field name="partner_id" />
                                        <field name="issue_date" />
                                        <field name="destruction_date" />
                                        <field name="total_items" />
                                        <field name="total_weight" />
                                        <field name="state" widget="badge" />
                                        <button name="action_download_pdf" type="object" string="Download" icon="fa-download" class="btn-link"/>
                                    </list>
                                </field>
                            </page>
                            <page string="Destruction Records" name="destructions">
                                <field name="destruction_record_ids" mode="list">
                                    <list>
                                        <field name="destruction_date"/>
                                        <field name="partner_id"/>
                                        <field name="method"/>
                                        <field name="items_destroyed"/>
                                        <field name="total_weight"/>
                                        <field name="witness_ids" widget="many2many_tags"/>
                                        <field name="certificate_id"/>
                                        <field name="certificate_issued_date"/>
                                        <field name="responsible_user_id"/>
                                        <field name="naid_compliant"/>
                                        <field name="state" widget="badge"/>
                                    </list>
                                </field>
                            </page>
                            <page string="Compliance Checklist" name="checklist">
                                <field name="compliance_checklist_ids" mode="list">
                                    <list editable="bottom">
                                        <field name="sequence" />
                                        <field name="name" />
                                        <field name="is_required" />
                                        <field name="is_checked" />
                                        <field name="description" />
                                        <field name="notes" />
                                    </list>
                                </field>
                            </page>
                            <page string="Performance Metrics" name="metrics">
                                <group>
                                    <group string="Compliance Metrics">
                                        <field name="overall_compliance_score" readonly="1" />
                                        <field name="security_score" readonly="1" />
                                        <field name="operational_score" readonly="1" />
                                        <field name="documentation_score" readonly="1" />
                                    </group>
                                    <group string="Timeline Metrics">
                                        <field name="days_since_last_audit" readonly="1" />
                                        <field name="days_until_expiry" readonly="1" />
                                        <field name="compliance_trend" readonly="1" />
                                        <field name="risk_level" readonly="1" />
                                    </group>
                                </group>
                                <field name="performance_history_ids" mode="list">
                                    <list>
                                        <field name="generation_date" />
                                        <field name="date_start" />
                                        <field name="date_end" />
                                        <field name="audits_passed_count" />
                                        <field name="audits_failed_count" />
                                        <field name="destruction_weight_total" />
                                        <field name="avg_destruction_time_hours" />
                                        <field name="compliance_alerts_triggered" />
                                        <field name="state" widget="badge" />
                                    </list>
                                </field>
                            </page>
                            <page string="Notifications" name="notifications">
                                <group>
                                    <group string="Alert Settings">
                                        <field name="expiry_notification" />
                                        <field name="audit_reminder" />
                                        <field name="compliance_alerts" />
                                        <field name="renewal_reminder" />
                                    </group>
                                    <group string="Recipients">
                                        <field name="notification_recipients" />
                                        <field name="escalation_contacts" />
                                        <field name="management_alerts" />
                                        <field name="regulatory_notifications" />
                                    </group>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" />
                        <field name="activity_ids" />
                        <field name="message_ids" />
                    </div>
                </form>
            </field>
        </record>
        <record id="naid_compliance_view_calendar" model="ir.ui.view">
            <field name="name">naid.compliance.view.calendar</field>
            <field name="model">naid.compliance</field>
            <field name="arch" type="xml">
                <calendar string="NAID Audit Schedule" date_start="next_audit_date" date_stop="expiry_date" color="naid_level">
                    <field name="name" />
                    <field name="facility_name" />
                    <field name="compliance_officer" />
                    <field name="naid_level" />
                    <field name="audit_required" />
                </calendar>
            </field>
        </record>
        <record id="naid_compliance_view_search" model="ir.ui.view">
            <field name="name">naid.compliance.view.search</field>
            <field name="model">naid.compliance</field>
            <field name="arch" type="xml">
                <search>
                    <field name="name" string="Compliance Record" />
                    <field name="facility_name" />
                    <field name="naid_member_id" />
                    <field name="compliance_officer" />
                    <filter string="Certified" name="certified" domain="[('compliance_status', '=', 'certified')]" />
                    <filter string="Pending Audit" name="pending_audit" domain="[('compliance_status', '=', 'pending_audit')]" />
                    <filter string="Non-Compliant" name="non_compliant" domain="[('compliance_status', '=', 'non_compliant')]" />
                    <filter string="Expired" name="expired" domain="[('compliance_status', '=', 'expired')]" />
                    <separator />
                    <filter string="NAID AAA" name="naid_aa" domain="[('naid_level', '=', 'AAA')]" />
                    <filter string="ü•à NAID AA" name="naid_aa" domain="[('naid_level', '=', 'AA')]" />
                    <filter string="ü•â NAID A" name="naid_a" domain="[('naid_level', '=', 'A')]" />
                    <separator />
                    <filter string="Valid Certificates" name="valid_certs" domain="[('certificate_valid', '=', True)]" />
                    <filter string="Audit Required" name="audit_required" domain="[('audit_required', '=', True)]" />
                    <filter string="Auto Renewal" name="auto_renewal" domain="[('auto_renewal', '=', True)]" />
                    <separator />
                    <!-- Refactored: replaced dynamic date arithmetic with boolean flags -->
                    <filter string="Expiring Soon (30 days)" name="expiring_soon" domain="[('expiry_within_30d', '=', True)]" />
                    <filter string="Overdue Audit" name="overdue_audit" domain="[('audit_overdue', '=', True)]" />
                    <group expand="0" string="Group By">
                        <filter string="NAID Level" name="group_by_naid_level" context="{'group_by': 'naid_level'}" />
                        <filter string="Compliance Status" name="group_by_status" context="{'group_by': 'compliance_status'}" />
                        <filter string="Facility" name="group_by_facility" context="{'group_by': 'facility_name'}" />
                        <filter string="Compliance Officer" name="group_by_officer" context="{'group_by': 'compliance_officer'}" />
                        <filter string="Expiry Date" name="group_by_expiry" context="{'group_by': 'expiry_date:month'}" />
                    </group>
                </search>
            </field>
        </record>
        <record id="action_naid_compliance" model="ir.actions.act_window">
            <!-- OPTIMIZATION: Model naid.compliance has state field - consider using default search filters -->
            <field name="name">NAID Compliance</field>
            <field name="res_model">naid.compliance</field>
            <field name="view_mode">list,form,calendar</field>
            <field name="search_view_id" ref="naid_compliance_view_search" />
            <field name="context">{
            'search_default_certified': 1,
            'search_default_valid_certs': 1
        }</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    <i class="fa fa-trophy"/> Set up your first NAID compliance certification!
                </p>
                <p>
                    <b>‚ö†Ô∏è Before creating NAID compliance records:</b>
                </p>
                <ul>
                    <li>‚úì <b>NAID Membership</b> - Ensure your organization has active NAID membership</li>
                    <li>‚úì <b>Facility Information</b> - Prepare facility name, address, and contact details</li>
                    <li>‚úì <b>Compliance Team</b> - Identify compliance officer, facility manager, and security officer</li>
                    <li>‚úì <b>Audit Schedule</b> - Plan for initial and ongoing audit frequency (annual recommended)</li>
                    <li>‚úì <b>Equipment Certification</b> - Verify all destruction equipment meets NAID standards</li>
                </ul>
                <p>
                    <b>üìã NAID Certification Levels:</b>
                </p>
                <ul>
                    <li><b>ü•á AAA (Highest):</b> Plant-based operations, rigorous security, annual audits</li>
                    <li><b>ü•à AA (Standard):</b> Mobile destruction services, enhanced protocols, bi-annual audits</li>
                    <li><b>ü•â A (Basic):</b> Off-site destruction, standard security, annual audits</li>
                </ul>
                <p>
                    <b>üéØ To set up NAID compliance:</b>
                </p>
                <ol>
                    <li>Click the <b>New</b> button above</li>
                    <li>Enter <b>Compliance Record Name</b> (e.g., "NAID-2025-AAA-001")</li>
                    <li>Select your target <b>NAID Level</b> (AAA, AA, or A)</li>
                    <li>Enter <b>NAID Member ID</b> and <b>Facility Name</b></li>
                    <li>Set <b>Certification Date</b> and <b>Expiry Date</b> (typically 1 year)</li>
                    <li>Assign <b>Compliance Officer</b> and other team members</li>
                    <li>Configure <b>Audit Frequency</b> and next audit date</li>
                    <li>Complete the <b>Compliance Checklist</b> in the checklist tab</li>
                    <li>Verify all <b>NAID Standards</b> (Physical, Personnel, Information, Operational Security)</li>
                    <li>Click <b>Conduct Audit</b> to schedule initial certification audit</li>
                </ol>
                <p>
                    <b>üìä Compliance Status Workflow:</b>
                </p>
                <ul>
                    <li><b>Draft:</b> Initial setup, compliance checklist in progress</li>
                    <li><b>Pending Audit:</b> Awaiting scheduled audit inspection</li>
                    <li><b>Certified:</b> Active certification, all requirements met</li>
                    <li><b>Non-Compliant:</b> Failed audit, corrective action required</li>
                    <li><b>Expired:</b> Certification expired, renewal needed</li>
                </ul>
                <p>
                    <b>üöÄ Enterprise Features:</b><br/>
                    ‚Ä¢ Complete NAID AAA/AA/A certification tracking<br/>
                    ‚Ä¢ Automated audit scheduling and management<br/>
                    ‚Ä¢ Digital certificate generation and tracking<br/>
                    ‚Ä¢ Comprehensive security standards compliance<br/>
                    ‚Ä¢ Multi-level personnel security verification<br/>
                    ‚Ä¢ Real-time performance metrics and analytics<br/>
                    ‚Ä¢ Proactive expiry and renewal notifications<br/>
                    ‚Ä¢ Detailed compliance checklists and workflows<br/>
                    ‚Ä¢ Integration with destruction and shredding services
                </p>
                <p>
                    <b>üí° Best Practice:</b> Schedule audits 60 days before expiry to allow time for corrective actions if needed. Enable <b>Auto Renewal</b> for continuous compliance.
                </p>
            </field>
        </record>
    </data>
</odoo>
