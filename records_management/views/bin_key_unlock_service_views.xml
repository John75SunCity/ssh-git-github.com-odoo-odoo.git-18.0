<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="bin_key_unlock_service_view_tree" model="ir.ui.view">
            <field name="name">bin.key.unlock.service.view.tree</field>
            <field name="model">bin.key.unlock.service</field>
            <field name="arch" type="xml">
                <list string="Bin Key Unlock Services" sample="1">
                    <field name="name" />
                    <field name="partner_id" />
                    <field name="bin_key_id" />
                    <field name="service_date" />
                    <field name="technician_id" />
                    <field name="state" decoration-success="state=='done'" decoration-info="state=='confirmed'" decoration-warning="state=='in_progress'" decoration-muted="state=='cancelled'" widget="badge" />
                    <field name="priority" widget="priority" />
                    <field name="unlock_charge" widget="monetary" optional="show" />
                    <field name="company_id" groups="base.group_multi_company" />
                </list>
            </field>
        </record>
        <record id="bin_key_unlock_service_view_form" model="ir.ui.view">
            <field name="name">bin.key.unlock.service.view.form</field>
            <field name="model">bin.key.unlock.service</field>
            <field name="arch" type="xml">
                <form string="Bin Key Unlock Service">
                    <header>
                        <button name="action_confirm" type="object" string="Confirm Service" class="oe_highlight" invisible="state != 'draft'" />
                        <button name="action_start_service" type="object" string="Start Service" class="oe_highlight" invisible="state != 'confirmed'" />
                        <button name="action_complete_service" type="object" string="Complete Service" class="oe_highlight" invisible="state != 'in_progress'" />
                        <button name="action_cancel" type="object" string="Cancel" invisible="state in ['done', 'cancelled']" />
                        <button name="action_reset_to_draft" type="object" string="Reset to Draft" invisible="state != 'cancelled'" />
                        <field name="state" widget="statusbar" statusbar_visible="draft,confirmed,in_progress,done,billed" />
                    </header>
                    <sheet>
                        <div class="oe_title">
                            <label for="name" />
                            <h1>
                                <field name="name" placeholder="Service Reference Number" />
                            </h1>
                        </div>
                        <group>
                            <group name="service_info" string="Service Information">
                                <field name="partner_id" />
                                <field name="bin_key_id" domain="[('partner_id', '=', partner_id)]" />
                                <field name="department_id" />
                                <field name="priority" widget="priority" />
                            </group>
                            <group name="scheduling" string="Schedule &amp; Resources">
                                <field name="service_date" />
                                <field name="completion_date" readonly="1" />
                                <field name="technician_id" />
                                <field name="emergency_access" widget="boolean_toggle" />
                            </group>
                        </group>
                        <notebook>
                            <page name="details" string="Details">
                                <group>
                                    <group name="reason" string="Unlock Reason">
                                        <field name="unlock_reason" />
                                        <field name="unlock_reason_description" />
                                    </group>
                                    <group name="service_detail" string="Service Details">
                                        <field name="unlock_bin_location" />
                                        <field name="shred_bin_id" />
                                    </group>
                                </group>
                                <separator string="Notes &amp; Items" />
                                <field name="service_notes" />
                                <field name="items_retrieved" />
                            </page>
                            <page name="verification" string="Verification &amp; Photos">
                                <group>
                                    <group name="verification_info" string="Verification">
                                        <field name="identity_verified" widget="boolean_toggle" />
                                        <field name="witness_id" />
                                    </group>
                                </group>
                                <separator string="Verification Photos" />
                                <field name="photo_ids" widget="many2many_kanban" />
                            </page>
                            <page name="billing" string="Billing">
                                <group>
                                    <group name="charges" string="Service Charges">
                                        <field name="unlock_charge" />
                                        <field name="billable" />
                                    </group>
                                    <group name="invoice_info" string="Invoice">
                                        <field name="invoice_id" readonly="1" />
                                    </group>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" />
                        <field name="activity_ids" />
                        <field name="message_ids" />
                    </div>
                </form>
            </field>
        </record>
        <record id="bin_key_unlock_service_view_search" model="ir.ui.view">
            <field name="name">bin.key.unlock.service.view.search</field>
            <field name="model">bin.key.unlock.service</field>
            <field name="arch" type="xml">
                <search string="Search Bin Key Unlock Services">
                    <field name="name" string="Service Reference" filter_domain="[('name', 'ilike', self)]" />
                    <field name="partner_id" string="Customer" />
                    <field name="bin_key_id" string="Bin Key" />
                    <field name="technician_id" string="Technician" />
                    <field name="department_id" string="Department" />
                    <separator />
                    <filter name="emergency" string="Emergency Access" domain="[('emergency_access', '=', True)]" />
                    <filter name="active_services" string="Active Services" domain="[('state', 'in', ['confirmed', 'in_progress'])]" />
                    <filter name="completed_services" string="Completed" domain="[('state', '=', 'done')]" />
                    <separator />
                    <group expand="0" string="Group By">
                        <filter name="group_partner" string="Customer" context="{'group_by': 'partner_id'}" />
                        <filter name="group_technician" string="Technician" context="{'group_by': 'technician_id'}" />
                        <filter name="group_state" string="Status" context="{'group_by': 'state'}" />
                        <filter name="group_service_date" string="Service Date" context="{'group_by': 'service_date:day'}" />
                        <filter name="group_department" string="Department" context="{'group_by': 'department_id'}" />
                    </group>
                </search>
            </field>
        </record>
        <record id="bin_key_unlock_service_view_kanban" model="ir.ui.view">
            <field name="name">bin.key.unlock.service.view.kanban</field>
            <field name="model">bin.key.unlock.service</field>
            <field name="arch" type="xml">
                <kanban default_group_by="state" class="o_kanban_small_column" sample="1">
                    <field name="name" />
                    <field name="partner_id" />
                    <field name="technician_id" />
                    <field name="service_date" />
                    <field name="priority" />
                    <field name="state" />
                    <field name="emergency_access" />
                    <field name="unlock_charge" />
                    <templates>
                        <t t-name="card">
                            <div t-attf-class="oe_kanban_card oe_kanban_global_click">
                                <div class="o_dropdown_kanban dropdown">
                                    <a role="button" class="dropdown-toggle o-no-caret btn" data-toggle="dropdown" href="#" aria-label="Dropdown menu" title="Dropdown menu">
                                        <span class="fa fa-ellipsis-v" aria-hidden="true" />
                                    </a>
                                    <div class="dropdown-menu" role="menu">
                                        <a name="action_confirm" type="object" class="dropdown-item" t-if="record.state.raw_value == 'draft'">Confirm Service</a>
                                        <a name="action_start_service" type="object" class="dropdown-item" t-if="record.state.raw_value == 'confirmed'">Start Service</a>
                                        <a name="action_complete_service" type="object" class="dropdown-item" t-if="record.state.raw_value == 'in_progress'">Complete Service</a>
                                        <div class="dropdown-divider" />
                                        <div class="dropdown-item-text text-muted">
                                            <small>Priority: <field name="priority" widget="priority" />
                                            </small>
                                        </div>
                                    </div>
                                </div>
                                <div class="oe_kanban_content">
                                    <div class="oe_kanban_details">
                                        <strong class="o_kanban_record_title">
                                            <field name="name" />
                                            <span t-if="record.emergency_access.raw_value" class="fa fa-exclamation-triangle text-danger" title="Emergency Access" />
                                        </strong>
                                        <div class="o_kanban_record_subtitle">
                                            <i class="fa fa-user" aria-hidden="true" />
                                            <field name="partner_id" />
                                        </div>
                                        <div class="o_kanban_record_subtitle" t-if="record.technician_id.raw_value">
                                            <i class="fa fa-wrench" aria-hidden="true" />
                                            <field name="technician_id" />
                                        </div>
                                        <div class="o_kanban_record_subtitle" t-if="record.service_date.raw_value">
                                            <i class="fa fa-calendar" aria-hidden="true" />
                                            <field name="service_date" />
                                        </div>
                                    </div>
                                    <div class="oe_kanban_footer">
                                        <div class="oe_kanban_footer_left">
                                            <span class="oe_kanban_record_subtitle">
                                                <field name="unlock_charge" widget="monetary" />
                                            </span>
                                        </div>
                                        <div class="oe_kanban_footer_right">
                                            <field name="priority" widget="priority" readonly="1" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>
        <record id="action_bin_key_unlock_service" model="ir.actions.act_window">
            <!-- OPTIMIZATION: Model bin.key.unlock.service has state field - consider using default search filters -->
            <field name="name">Bin Key Unlock Services</field>
            <field name="res_model">bin.key.unlock.service</field>
            <field name="view_mode">list,form</field>
            <field name="domain">[]</field>
            <field name="context">{}</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_create">
            Click to create a new bin key unlock service request.
        </p>
                <p>
            This feature allows you to manage and track bin key unlock services,
            including emergency access requests, security verification, and
            compliance audit trails.
        </p>
            </field>
        </record>
    
        <menuitem id="menu_bin_key_unlock_service" name="Unlock Services" parent="records_management.menu_security_access" action="action_bin_key_unlock_service" sequence="30" />
    
    
    </data>
</odoo>
