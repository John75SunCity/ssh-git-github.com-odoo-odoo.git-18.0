<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
<!-- ============================================================================= -->
<!-- List view for Customer -->
<!-- ============================================================================= -->

<!-- Form view for base.rate -->
    <record id="customer_portal_diagram_view_form" model="ir.ui.view">
        <field name="name">customer.portal.diagram.view.form</field>
        <field name="model">customer.portal.diagram</field>
        <field name="arch" type="xml">
        <form string="Portal Organization Diagram">
            <header>
                <button name="action_refresh_diagram" type="object" string="Refresh" class="btn-primary"/>
                <button name="action_export_diagram_data" type="object" string="Export" class="btn-secondary"/>
            </header>
            <sheet>
                <div class="oe_title">
                    <h1>
        <field name="name" placeholder="Diagram Name"/>
                    </h1>
                </div>

                <group>
                    <group name="basic_info" string="Basic Information">
        <field name="company_id" readonly="1"/>
        <field name="user_id" readonly="1"/>
                    </group>
                    <group name="configuration" string="Configuration">
        <field name="layout_type"/>
        <field name="show_access_rights"/>
        <field name="show_messaging"/>
                    </group>
                </group>

                <group string="Search &amp;amp; Filters">
                    <group>
        <field name="search_query" placeholder="Search nodes and edges..."/>
        <field name="search_user_id" domain="[('company_id', '=', company_id)]"/>
                    </group>
                    <group>
        <field name="search_company_id"/>
        <field name="search_department_id" domain="[('company_id', '=', company_id)]"/>
                    </group>
                </group>

                <notebook>
                    <page string="Diagram Statistics" name="stats">
        <field name="diagram_stats" widget="text" readonly="1"/>
                    </page>
                    <page string="Advanced Settings" name="advanced">
                        <group>
        <field name="restricted_models" placeholder="model.name1,model.name2"/>
        <field name="allowed_user_ids" widget="many2many_tags" domain="[('company_id', '=', company_id)]"/>
                        </group>
                    </page>
                </notebook>
            </sheet>
            <div class="oe_chatter">
        <field name="message_follower_ids"/>
        <field name="activity_ids"/>
        <field name="message_ids"/>
            </div>
        </form>
    </field>
    </record>

<!-- List view for Custom -->
    <record id="customer_portal_diagram_view_tree" model="ir.ui.view">
        <field name="name">customer.portal.diagram.view.tree</field>
        <field name="model">customer.portal.diagram</field>
        <field name="arch" type="xml">
        <customer_portal_diagram>
    <!-- Technical JSON/layout fields - stored for client rendering logic; intentionally hidden from UI -->
    <field name="node_data" invisible="1"/>
    <field name="edge_data" invisible="1"/>
    <field name="diagram_stats" invisible="1"/>
    <field name="show_messaging" invisible="1"/>
    <field name="layout_type" invisible="1"/>
        </customer_portal_diagram>
    </field>
    </record>

<!-- List view for base.rate -->
    <record id="customer_portal_diagram_view_tree" model="ir.ui.view">
        <field name="name">customer.portal.diagram.view.tree</field>
        <field name="model">customer.portal.diagram</field>
        <field name="arch" type="xml">
        <list string="Portal Diagrams" create="true" delete="true">
        <field name="name"/>
        <field name="user_id"/>
        <field name="company_id"/>
        <field name="show_access_rights"/>
        <field name="show_messaging"/>
        <field name="layout_type"/>
        </list>
    </field>
    </record>

<!-- Search view for base.rate -->
    <record id="customer_portal_diagram_view_search" model="ir.ui.view">
        <field name="name">customer.portal.diagram.view.search</field>
        <field name="model">customer.portal.diagram</field>
        <field name="arch" type="xml">
        <search string="Search Portal Diagrams">
        <field name="name" string="Diagram Name"/>
        <field name="user_id" string="Created By"/>
        <field name="company_id" string="Company"/>
        <field name="search_query" string="Search Query"/>

            <filter string="My Diagrams" name="my_diagrams" domain="[('user_id', '=', uid)]"/>
            <filter string="With Messaging" name="with_messaging" domain="[('show_messaging', '=', True)]"/>
            <filter string="With Access Rights" name="with_access" domain="[('show_access_rights', '=', True)]"/>

            <separator/>
            <filter string="Hierarchical Layout" name="hierarchical" domain="[('layout_type', '=', 'hierarchical')]"/>
            <filter string="Network Layout" name="network" domain="[('layout_type', '=', 'network')]"/>
            <filter string="Circular Layout" name="circular" domain="[('layout_type', '=', 'circular')]"/>

            <group expand="0" string="Group By">
                <filter string="Company" name="group_company" context="{'group_by': 'company_id'}"/>
                <filter string="Layout Type" name="group_layout" context="{'group_by': 'layout_type'}"/>
                <filter string="Created By" name="group_user" context="{'group_by': 'user_id'}"/>
            </group>
        </search>
    </field>
    </record>

<!-- ============================================================================= -->
<!-- List view for Actions -->
<!-- ============================================================================= -->

<!-- List view for Main -->
    <record id="action_customer_portal_diagram" model="ir.actions.act_window">
        <field name="name">Organization Diagram</field>
        <field name="res_model">customer.portal.diagram</field>
        <field name="view_mode">list</field>
        <field name="view_id" ref="customer_portal_diagram_view"/>
        <field name="target">current</field>
        <field name="help" type="html">
        <p class="o_view_nocontent_smiling_face">
            Welcome to Your Organization Diagram!
        </p>
        <p>
            This interactive diagram shows your company's organizational structure,
            including departments, colleagues, and communication pathways.
        </p>
        <p>
            <strong>Features:</strong>
        </p>
        <ul>
            <li>Interactive organizational chart with real-time updates</li>
            <li>Click on colleagues to send messages directly</li>
            <li>Search for specific people or departments</li>
            <li>Visual representation of your company hierarchy</li>
            <li>Access rights visualization (for managers)</li>
        </ul>
        <p>
            <i class="fa fa-lightbulb-o"/>
            <strong>Tip:</strong>
            Click "Create" to generate your first organizational diagram with custom filters.
        </p>
    </field>
    </record>

<!-- List view for Action -->
    <record id="action_customer_portal_diagram_admin" model="ir.actions.act_window">
        <field name="name">Portal Diagram Configuration</field>
        <field name="res_model">customer.portal.diagram</field>
        <field name="view_mode">list,form</field>
        <field name="view_id" ref="customer_portal_diagram_view_tree"/>
        <field name="target">current</field>
        <field name="help" type="html">
        <p class="o_view_nocontent_smiling_face">
            Configure Customer Portal Diagrams
        </p>
        <p>
            Manage how customers view organizational diagrams in their portal.
            Configure access rights, messaging capabilities, and layout options.
        </p>
    </field>
    </record>

<!-- List view for Simplified -->
    <record id="action_customer_portal_diagram_simple" model="ir.actions.client">
        <field name="name">My Organization</field>
        <field name="tag">customer_portal_diagram</field>
        <field name="target">current</field>
        <field name="params">{
        'auto_create': true,
        'default_layout': 'hierarchical',
        'show_messaging': true
    }</field>
    </record>

<!-- ============================================================================= -->
<!-- List view for Menu -->
<!-- ============================================================================= -->

<!-- List view for Main -->

    <!-- Portal Organization moved to Configuration menu -->
    <menuitem id="menu_customer_portal_diagram" name="Portal Organization" parent="menu_records_configuration" action="action_customer_portal_diagram_admin" sequence="65" groups="records_management.group_records_manager"/>


<!-- List view for Submenu -->

    <menuitem id="menu_customer_portal_diagram_config" name="Diagram Configuration" parent="menu_records_configuration" action="action_customer_portal_diagram_admin" sequence="50" groups="records_management.group_records_manager"/>

    
    </data>
</odoo>
