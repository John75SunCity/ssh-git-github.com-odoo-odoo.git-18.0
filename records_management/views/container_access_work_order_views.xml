<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="container_access_work_order_view_tree" model="ir.ui.view">
            <field name="name">container.access.work.order.view.tree</field>
            <field name="model">container.access.work.order</field>
            <field name="arch" type="xml">
                <list>
                    <field name="name" />
                    <field name="portal_visible" widget="boolean_toggle" optional="show"/>
                </list>
            </field>
        </record>
        <record id="container_access_work_order_view_form" model="ir.ui.view">
            <field name="name">container.access.work.order.view.form</field>
            <field name="model">container.access.work.order</field>
            <field name="arch" type="xml">
                <form string="Container Access Work Order">
                    <header>
                        <button name="action_submit" string="Submit" type="object" 
                                invisible="state != 'draft'" class="oe_highlight"/>
                        <button name="action_approve" string="Approve" type="object" 
                                invisible="state != 'submitted'" class="oe_highlight"/>
                        <button name="action_schedule" string="Schedule" type="object" 
                                invisible="state != 'approved'" class="oe_highlight"/>
                        <button name="action_open_scanner" string="üì∑ Scan Barcodes" type="object" 
                                class="btn-primary" 
                                invisible="state not in ['scheduled','in_progress']" 
                                icon="fa-barcode"
                                help="Open barcode scanner to verify containers and files"/>
                        <button name="action_start" string="Start Access" type="object" 
                                invisible="state != 'scheduled'" class="oe_highlight"/>
                        <button name="action_complete" string="Complete" type="object" 
                                invisible="state != 'in_progress'" class="btn-success"/>
                        <button name="action_cancel" string="Cancel" type="object" 
                                invisible="state in ['completed', 'documented', 'closed', 'cancelled']"/>
                        <field name="state" widget="statusbar" 
                               statusbar_visible="draft,submitted,approved,scheduled,in_progress,completed"/>
                    </header>
                    <sheet>
                        <div class="oe_title">
                            <label for="name" />
                            <h1>
                                <field name="name" placeholder="Name..." />
                            </h1>
                        </div>
                        <group>
                            <group string="Customer Information">
                                <field name="partner_id"/>
                                <field name="access_type"/>
                                <field name="access_purpose"/>
                            </group>
                            <group string="Portal &amp; Scheduling">
                                <field name="portal_visible"/>
                                <field name="scheduled_access_date"/>
                                <field name="scheduled_duration_hours"/>
                            </group>
                        </group>
                        <notebook>
                            <page name="containers" string="Containers">
                                <field name="container_ids">
                                    <list>
                                        <field name="name"/>
                                        <field name="barcode"/>
                                        <field name="partner_id"/>
                                        <field name="state"/>
                                    </list>
                                </field>
                            </page>
                            <page name="barcode_scanning" string="üì∑ Barcode Scanning" invisible="state not in ['scheduled','in_progress']">
                                <group>
                                    <group string="Scanning Status">
                                        <field name="scanned_count" readonly="1"/>
                                        <field name="last_scan_time" readonly="1"/>
                                    </group>
                                </group>
                                <separator string="Scanned Containers"/>
                                <field name="scanned_barcode_ids" widget="many2many_tags" options="{'color_field': 'color', 'no_create': True}"/>
                                <div class="alert alert-info" role="status">
                                    <p><i class="fa fa-info-circle"/> <strong>How to Scan:</strong></p>
                                    <ul>
                                        <li><strong>USB Scanner:</strong> Focus on barcode field and scan</li>
                                        <li><strong>Mobile:</strong> Tap camera icon to scan with phone camera</li>
                                        <li><strong>Manual:</strong> Type barcode and press Enter</li>
                                    </ul>
                                </div>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids"/>
                        <field name="activity_ids"/>
                        <field name="message_ids"/>
                    </div>
                </form>
            </field>
        </record>
        <record id="container_access_work_order_view_search" model="ir.ui.view">
            <field name="name">container.access.work.order.view.search</field>
            <field name="model">container.access.work.order</field>
            <field name="arch" type="xml">
                <search>
                    <group expand="1" string="Group By">
                        <filter string="Name" name="name" domain="[]" context="{'group_by':'name'}" />
                    </group>
                </search>
            </field>
        </record>
        <record id="action_container_access_work_order" model="ir.actions.act_window">
            <!-- OPTIMIZATION: Model container.access.work.order has state field - consider using default search filters -->
            <field name="name">Container Access Work Orders</field>
            <field name="res_model">container.access.work.order</field>
            <field name="view_mode">list,form</field>
            <field name="domain">[]</field>
            <field name="context">{}</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    <i class="fa fa-unlock-alt"/> No container access work orders yet!
                </p>
                <p>
                    <b>‚ö†Ô∏è Prerequisites:</b>
                </p>
                <ul>
                    <li>‚úì <b>Customer Containers</b> - Go to: <i>Records Management &gt; Containers</i></li>
                    <li>‚úì <b>Secure Access Room</b> - Go to: <i>Records Management &gt; Locations</i></li>
                    <li>‚úì <b>Staff Supervision</b> - Go to: <i>Employees &gt; Access Control Team</i></li>
                </ul>
                <p>
                    <b>üìã To schedule container access:</b>
                </p>
                <ol>
                    <li>Click "Create" and select <b>Customer/Partner</b></li>
                    <li>Choose <b>Container(s)</b> customer wants to access</li>
                    <li>Set <b>Access Date/Time</b> and <b>Duration</b></li>
                    <li>Assign <b>Supervising Staff Member</b> (required for security)</li>
                    <li>Specify <b>Access Location</b> (viewing room, secure area)</li>
                    <li>Add <b>Visitor Information</b> (name, ID verification, company)</li>
                    <li>Set <b>Access Type</b>:
                        <ul>
                            <li><b>View Only:</b> Customer looks at documents, no removal</li>
                            <li><b>Add Documents:</b> Customer adds new items to container</li>
                            <li><b>Remove Documents:</b> Customer pulls specific files (logged)</li>
                            <li><b>Full Access:</b> Complete container manipulation with audit trail</li>
                        </ul>
                    </li>
                    <li>Enable <b>Portal Visible</b> if customer can see work order status in their portal</li>
                    <li>Click <b>Confirm</b> to schedule and notify customer</li>
                    <li>Staff pulls containers to viewing room before appointment</li>
                    <li>Log <b>Check-In Time</b> when visitor arrives (with ID verification)</li>
                    <li>Supervisor monitors access and logs any document removals</li>
                    <li>Take <b>Before/After Photos</b> of container if documents removed</li>
                    <li>Visitor signs <b>Access Activity Log</b> confirming items taken</li>
                    <li>Click <b>Complete</b> when visitor leaves, container returned to storage</li>
                </ol>
                <p>
                    <b>üìä Access States:</b>
                </p>
                <ul>
                    <li><b>Scheduled:</b> Appointment booked, containers identified, supervisor assigned</li>
                    <li><b>Prepared:</b> Containers pulled from storage, viewing room ready, awaiting visitor</li>
                    <li><b>In Progress:</b> Visitor actively accessing containers under staff supervision</li>
                    <li><b>Completed:</b> Access finished, containers returned, audit log sealed, photos attached</li>
                    <li><b>Cancelled:</b> Visitor no-show or reschedule request, containers returned to storage</li>
                </ul>
                <p>
                    <b>üöÄ Key Features:</b><br/>
                    ‚Ä¢ <b>Security Compliance:</b> Mandatory staff supervision, ID verification, video monitoring<br/>
                    ‚Ä¢ <b>Audit Trail:</b> Complete log of who accessed what, when, for how long, what was removed<br/>
                    ‚Ä¢ <b>Document Tracking:</b> Log every document removed with description, reason, authorization<br/>
                    ‚Ä¢ <b>Photo Documentation:</b> Before/after container photos for chain of custody<br/>
                    ‚Ä¢ <b>Visitor Management:</b> Check-in/check-out times, ID copies, signature capture<br/>
                    ‚Ä¢ <b>Portal Integration:</b> Customers can request/track access appointments online<br/>
                    ‚Ä¢ <b>Access Reports:</b> Generate visitor access reports for customer billing or compliance<br/>
                </p>
                <p>
                    <b>üí° Pro Tips:</b><br/>
                    ‚Ä¢ Always verify <b>visitor ID</b> and match to authorized access list before allowing entry<br/>
                    ‚Ä¢ Use <b>Portal Visible</b> toggle to let customers track appointment status in real-time<br/>
                    ‚Ä¢ Take <b>photos</b> if ANY documents removed - protects against later disputes<br/>
                    ‚Ä¢ Set <b>time limits</b> for access - prevents excessive viewing room occupation<br/>
                    ‚Ä¢ <b>Bill separately</b> for access appointments - labor cost + room reservation fee<br/>
                </p>
            </field>
        </record>
    </data>
</odoo>
