<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- ================================================================== -->
    <!-- PORTAL CALENDAR VIEW - Customer Service Schedule                  -->
    <!-- Shows scheduled shredding services, pickups, retrievals, etc.     -->
    <!-- ================================================================== -->

    <template id="portal_calendar_view" name="My Service Calendar">
        <t t-call="portal.portal_layout">
            <t t-set="breadcrumbs_searchbar" t-value="True"/>

            <t t-call="portal.portal_searchbar">
                <t t-set="title">My Service Calendar</t>
            </t>

            <div class="container mt-4">
                <!-- Page Header -->
                <div class="row mb-4">
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-body">
                                <h2 class="mb-3">
                                    <i class="fa fa-calendar fa-fw"></i>
                                    My Scheduled Services
                                </h2>
                                <p class="text-muted mb-0">
                                    View all your upcoming services, pickups, and appointments.
                                    This includes recurring shredding services, container pickups, document retrievals, and scheduled deliveries.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Legend -->
                <div class="row mb-3">
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-body">
                                <h6 class="mb-3">Calendar Legend</h6>
                                <div class="row">
                                    <div class="col-md-3 col-6 mb-2">
                                        <span class="badge badge-pill" style="background-color: #8B0000; padding: 8px 12px;">
                                            <i class="fa fa-shredder"></i> Shredding Service
                                        </span>
                                    </div>
                                    <div class="col-md-3 col-6 mb-2">
                                        <span class="badge badge-pill" style="background-color: #007bff; padding: 8px 12px;">
                                            <i class="fa fa-truck"></i> Pickup
                                        </span>
                                    </div>
                                    <div class="col-md-3 col-6 mb-2">
                                        <span class="badge badge-pill" style="background-color: #28a745; padding: 8px 12px;">
                                            <i class="fa fa-download"></i> Retrieval
                                        </span>
                                    </div>
                                    <div class="col-md-3 col-6 mb-2">
                                        <span class="badge badge-pill" style="background-color: #ffc107; padding: 8px 12px;">
                                            <i class="fa fa-box"></i> Delivery
                                        </span>
                                    </div>
                                    <div class="col-md-3 col-6 mb-2">
                                        <span class="badge badge-pill" style="background-color: #dc3545; padding: 8px 12px;">
                                            <i class="fa fa-fire"></i> Destruction
                                        </span>
                                    </div>
                                    <div class="col-md-3 col-6 mb-2">
                                        <span class="badge badge-pill" style="background-color: #6610f2; padding: 8px 12px;">
                                            <i class="fa fa-clipboard-list"></i> Request
                                        </span>
                                    </div>
                                    <div class="col-md-3 col-6 mb-2">
                                        <span class="badge badge-pill" style="background-color: #20c997; padding: 8px 12px;">
                                            <i class="fa fa-file-alt"></i> Document Access
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Calendar Container -->
                <div class="row">
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-body">
                                <!-- Loading Indicator -->
                                <div id="calendar-loading" class="text-center py-5">
                                    <i class="fa fa-spinner fa-spin fa-3x text-primary"></i>
                                    <p class="mt-3 text-muted">Loading your scheduled services...</p>
                                </div>
                                
                                <!-- Calendar Element -->
                                <div id="portal-calendar" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Event Details Modal (Bootstrap 5) -->
                <div class="modal fade" id="eventDetailsModal" tabindex="-1" aria-labelledby="eventModalTitle" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="eventModalTitle">Event Details</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body" id="eventModalBody">
                                <!-- Dynamic content -->
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                <a href="#" id="eventViewDetailsBtn" class="btn btn-primary" style="display: none;">View Details</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FullCalendar CSS -->
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css"/>

            <!-- FullCalendar JS Library -->
            <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
            
            <!-- 
                Portal Calendar Widget loaded via web.assets_frontend bundle:
                records_management/static/src/js/portal/portal_calendar_widget.js
                
                This follows Odoo 18 best practices:
                - Vanilla JavaScript (no odoo.define or publicWidget)
                - IIFE pattern for module isolation
                - Native fetch() for AJAX
                - Auto-initializes when #portal-calendar element is present
            -->
        </t>
    </template>
</odoo>
