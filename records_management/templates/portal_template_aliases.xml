<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <!--
            Portal Template Aliases
            These templates create aliases for controllers that call template IDs
            that don't match the actual template names.
            This fixes "missing page" errors in the portal.
        -->

        <!-- Enhanced Dashboard → Portal Dashboard -->
        <template id="enhanced_dashboard" name="Enhanced Dashboard (Alias)">
            <t t-call="records_management.portal_dashboard"/>
        </template>

        <!-- Analytics Dashboard → Portal Dashboard -->
        <template id="analytics_dashboard" name="Analytics Dashboard">
            <t t-call="records_management.portal_dashboard"/>
        </template>

        <!-- Container Summary Report → Portal Dashboard (or create proper report) -->
        <template id="container_summary_report" name="Container Summary Report">
            <t t-call="portal.portal_layout">
                <t t-set="title">Container Summary Report</t>
                <div class="container mt-4">
                    <div class="card">
                        <div class="card-header bg-primary text-white">
                            <h3 class="mb-0">
                                <i class="fa fa-chart-bar"></i>
                                Container Summary Report
                            </h3>
                        </div>
                        <div class="card-body">
                            <div class="alert alert-info">
                                <strong>Report Data:</strong> This report shows summary statistics for your container inventory.
                            </div>

                            <div class="row">
                                <div class="col-md-4">
                                    <div class="card text-center">
                                        <div class="card-body">
                                            <h2 class="text-primary" t-esc="container_count or 0"/>
                                            <p class="text-muted">Total Containers</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card text-center">
                                        <div class="card-body">
                                            <h2 class="text-success" t-esc="active_count or 0"/>
                                            <p class="text-muted">Active</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card text-center">
                                        <div class="card-body">
                                            <h2 class="text-warning" t-esc="archived_count or 0"/>
                                            <p class="text-muted">Archived</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="mt-4">
                                <a href="/my/containers" class="btn btn-primary">
                                    <i class="fa fa-list"></i> View All Containers
                                </a>
                                <a href="/my" class="btn btn-secondary">
                                    <i class="fa fa-home"></i> Back to Portal
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </t>
        </template>

        <!-- Portal Inventory Enhanced → Portal My Inventory -->
        <template id="portal_inventory_enhanced" name="Portal Inventory Enhanced (Alias)">
            <t t-call="records_management.portal_my_inventory"/>
        </template>

        <!-- Portal Stock Movements -->
        <template id="portal_stock_movements" name="Stock Movements">
            <t t-call="portal.portal_layout">
                <t t-set="title">Stock Movements</t>
                <div class="container mt-4">
                    <div class="card">
                        <div class="card-header bg-info text-white">
                            <h3 class="mb-0">
                                <i class="fa fa-exchange-alt"></i>
                                Stock Movement History
                            </h3>
                        </div>
                        <div class="card-body">
                            <t t-if="not movements">
                                <div class="alert alert-info">
                                    No stock movements found.
                                </div>
                            </t>
                            <t t-else="">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Container</th>
                                            <th>From Location</th>
                                            <th>To Location</th>
                                            <th>State</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <t t-foreach="movements" t-as="move">
                                            <tr>
                                                <td t-esc="move.date"/>
                                                <td t-esc="move.container_id.name if move.container_id else '-'"/>
                                                <td t-esc="move.location_id.name if move.location_id else '-'"/>
                                                <td t-esc="move.location_dest_id.name if move.location_dest_id else '-'"/>
                                                <td>
                                                    <span class="badge" t-attf-class="badge-{{ 'success' if move.state == 'done' else 'warning' }}">
                                                        <t t-esc="move.state"/>
                                                    </span>
                                                </td>
                                            </tr>
                                        </t>
                                    </tbody>
                                </table>

                                <t t-if="pager">
                                    <t t-call="portal.pager"/>
                                </t>
                            </t>

                            <div class="mt-3">
                                <a href="/my/inventory" class="btn btn-primary">
                                    <i class="fa fa-arrow-left"></i> Back to Inventory
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </t>
        </template>

        <!-- Portal Container Movements -->
        <template id="portal_container_movements" name="Container Movements">
            <t t-call="portal.portal_layout">
                <t t-set="title">Container Movement History</t>
                <div class="container mt-4">
                    <div class="card">
                        <div class="card-header bg-success text-white">
                            <h3 class="mb-0">
                                <i class="fa fa-boxes"></i>
                                Container Movement History
                            </h3>
                        </div>
                        <div class="card-body">
                            <t t-if="container">
                                <div class="alert alert-info mb-3">
                                    <strong>Container:</strong> <t t-esc="container.name"/>
                                    <t t-if="container.barcode">
                                        <br/><strong>Barcode:</strong> <t t-esc="container.barcode"/>
                                    </t>
                                </div>
                            </t>

                            <t t-if="not movements">
                                <div class="alert alert-info">
                                    No movement history available for this container.
                                </div>
                            </t>
                            <t t-else="">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>From</th>
                                            <th>To</th>
                                            <th>Quantity</th>
                                            <th>Status</th>
                                            <th>User</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <t t-foreach="movements" t-as="move">
                                            <tr>
                                                <td t-field="move.date"/>
                                                <td t-esc="move.location_id.name if move.location_id else '-'"/>
                                                <td t-esc="move.location_dest_id.name if move.location_dest_id else '-'"/>
                                                <td t-esc="move.product_uom_qty"/>
                                                <td>
                                                    <span class="badge" t-attf-class="badge-{{ 'success' if move.state == 'done' else 'warning' }}">
                                                        <t t-esc="move.state"/>
                                                    </span>
                                                </td>
                                                <td t-esc="move.create_uid.name if move.create_uid else '-'"/>
                                            </tr>
                                        </t>
                                    </tbody>
                                </table>

                                <t t-if="pager">
                                    <t t-call="portal.pager"/>
                                </t>
                            </t>

                            <div class="mt-3">
                                <a t-if="container" t-attf-href="/my/container/{{container.id}}" class="btn btn-primary">
                                    <i class="fa fa-arrow-left"></i> Back to Container
                                </a>
                                <a href="/my/containers" class="btn btn-secondary">
                                    <i class="fa fa-list"></i> All Containers
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </t>
        </template>

    </data>
</odoo>
