<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <!-- ============================================================
             PORTAL SPREADSHEET TEMPLATES - CUSTOMER PORTAL
             ============================================================
             
             Templates for the customer portal spreadsheet template center.
             Customers can browse, download, and use import/export templates.
        -->

        <!-- Spreadsheet Templates List Page -->
        <template id="portal_spreadsheet_templates" name="Spreadsheet Templates">
            <t t-call="portal.portal_layout">
                <t t-set="breadcrumbs_searchbar" t-value="True"/>
                <t t-set="title">Spreadsheet Templates</t>

                <div class="o_portal_spreadsheet_templates">
                    <!-- Header Card -->
                    <div class="card mb-4">
                        <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                            <h3 class="mb-0">
                                <i class="fa fa-file-excel-o me-2"></i>
                                Import &amp; Export Templates
                            </h3>
                            <div class="btn-group" role="group">
                                <a href="/my/inventory" class="btn btn-light btn-sm">
                                    <i class="fa fa-arrow-left me-1"></i> Back to Inventory
                                </a>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="alert alert-info mb-0">
                                <i class="fa fa-info-circle me-2"></i>
                                <strong>How to use:</strong> Download a template, fill in your data following the instructions in row 2, 
                                then upload the completed spreadsheet using the import function on each page.
                            </div>
                        </div>
                    </div>

                    <!-- Template Categories -->
                    <div class="row">
                        <!-- Containers Templates -->
                        <div class="col-lg-6 mb-4">
                            <div class="card h-100">
                                <div class="card-header bg-success text-white">
                                    <h5 class="mb-0">
                                        <i class="fa fa-archive me-2"></i> Container Templates
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <p class="text-muted">Import and export container/box records.</p>
                                    <div class="list-group list-group-flush">
                                        <t t-foreach="templates_by_type.get('containers', [])" t-as="template">
                                            <a t-attf-href="/my/spreadsheet/template/#{template.id}/download" 
                                               class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                                                <div>
                                                    <i class="fa fa-file-excel-o text-success me-2"></i>
                                                    <strong t-esc="template.name"/>
                                                    <t t-if="template.description">
                                                        <br/>
                                                        <small class="text-muted" t-esc="template.description"/>
                                                    </t>
                                                </div>
                                                <span class="badge bg-success">
                                                    <i class="fa fa-download"></i> Download
                                                </span>
                                            </a>
                                        </t>
                                        <t t-if="not templates_by_type.get('containers')">
                                            <div class="list-group-item text-center text-muted py-4">
                                                <i class="fa fa-file-o fa-2x mb-2 d-block"></i>
                                                No templates available
                                            </div>
                                        </t>
                                    </div>
                                    <div class="mt-3">
                                        <a href="/my/import/template/containers" class="btn btn-outline-success btn-sm">
                                            <i class="fa fa-download me-1"></i> Download Default Template
                                        </a>
                                        <a href="/my/inventory/containers" class="btn btn-outline-secondary btn-sm ms-2">
                                            <i class="fa fa-upload me-1"></i> Import Data
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Files Templates -->
                        <div class="col-lg-6 mb-4">
                            <div class="card h-100">
                                <div class="card-header bg-info text-white">
                                    <h5 class="mb-0">
                                        <i class="fa fa-folder-open me-2"></i> File Folder Templates
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <p class="text-muted">Import and export file folder records.</p>
                                    <div class="list-group list-group-flush">
                                        <t t-foreach="templates_by_type.get('files', [])" t-as="template">
                                            <a t-attf-href="/my/spreadsheet/template/#{template.id}/download" 
                                               class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                                                <div>
                                                    <i class="fa fa-file-excel-o text-info me-2"></i>
                                                    <strong t-esc="template.name"/>
                                                    <t t-if="template.description">
                                                        <br/>
                                                        <small class="text-muted" t-esc="template.description"/>
                                                    </t>
                                                </div>
                                                <span class="badge bg-info">
                                                    <i class="fa fa-download"></i> Download
                                                </span>
                                            </a>
                                        </t>
                                        <t t-if="not templates_by_type.get('files')">
                                            <div class="list-group-item text-center text-muted py-4">
                                                <i class="fa fa-file-o fa-2x mb-2 d-block"></i>
                                                No templates available
                                            </div>
                                        </t>
                                    </div>
                                    <div class="mt-3">
                                        <a href="/my/import/template/files" class="btn btn-outline-info btn-sm">
                                            <i class="fa fa-download me-1"></i> Download Default Template
                                        </a>
                                        <a href="/my/inventory/files" class="btn btn-outline-secondary btn-sm ms-2">
                                            <i class="fa fa-upload me-1"></i> Import Data
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Documents Templates -->
                        <div class="col-lg-6 mb-4">
                            <div class="card h-100">
                                <div class="card-header bg-warning text-dark">
                                    <h5 class="mb-0">
                                        <i class="fa fa-file-text me-2"></i> Document Templates
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <p class="text-muted">Import and export document records.</p>
                                    <div class="list-group list-group-flush">
                                        <t t-foreach="templates_by_type.get('documents', [])" t-as="template">
                                            <a t-attf-href="/my/spreadsheet/template/#{template.id}/download" 
                                               class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                                                <div>
                                                    <i class="fa fa-file-excel-o text-warning me-2"></i>
                                                    <strong t-esc="template.name"/>
                                                    <t t-if="template.description">
                                                        <br/>
                                                        <small class="text-muted" t-esc="template.description"/>
                                                    </t>
                                                </div>
                                                <span class="badge bg-warning text-dark">
                                                    <i class="fa fa-download"></i> Download
                                                </span>
                                            </a>
                                        </t>
                                        <t t-if="not templates_by_type.get('documents')">
                                            <div class="list-group-item text-center text-muted py-4">
                                                <i class="fa fa-file-o fa-2x mb-2 d-block"></i>
                                                No templates available
                                            </div>
                                        </t>
                                    </div>
                                    <div class="mt-3">
                                        <a href="/my/documents" class="btn btn-outline-secondary btn-sm">
                                            <i class="fa fa-upload me-1"></i> Import Data
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Users Templates (Admin Only) -->
                        <t t-if="is_company_admin">
                            <div class="col-lg-6 mb-4">
                                <div class="card h-100">
                                    <div class="card-header bg-danger text-white">
                                        <h5 class="mb-0">
                                            <i class="fa fa-users me-2"></i> Portal User Templates
                                            <span class="badge bg-light text-danger ms-2">Admin Only</span>
                                        </h5>
                                    </div>
                                    <div class="card-body">
                                        <p class="text-muted">Import and export portal user accounts.</p>
                                        <div class="list-group list-group-flush">
                                            <t t-foreach="templates_by_type.get('users', [])" t-as="template">
                                                <a t-attf-href="/my/spreadsheet/template/#{template.id}/download" 
                                                   class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                                                    <div>
                                                        <i class="fa fa-file-excel-o text-danger me-2"></i>
                                                        <strong t-esc="template.name"/>
                                                        <t t-if="template.description">
                                                            <br/>
                                                            <small class="text-muted" t-esc="template.description"/>
                                                        </t>
                                                    </div>
                                                    <span class="badge bg-danger">
                                                        <i class="fa fa-download"></i> Download
                                                    </span>
                                                </a>
                                            </t>
                                            <t t-if="not templates_by_type.get('users')">
                                                <div class="list-group-item text-center text-muted py-4">
                                                    <i class="fa fa-file-o fa-2x mb-2 d-block"></i>
                                                    No templates available
                                                </div>
                                            </t>
                                        </div>
                                        <div class="mt-3">
                                            <a href="/my/import/template/users" class="btn btn-outline-danger btn-sm">
                                                <i class="fa fa-download me-1"></i> Download Default Template
                                            </a>
                                            <a href="/my/team" class="btn btn-outline-secondary btn-sm ms-2">
                                                <i class="fa fa-upload me-1"></i> Import Users
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </t>

                        <!-- Service Requests Templates -->
                        <div class="col-lg-6 mb-4">
                            <div class="card h-100">
                                <div class="card-header bg-secondary text-white">
                                    <h5 class="mb-0">
                                        <i class="fa fa-ticket me-2"></i> Service Request Templates
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <p class="text-muted">Bulk import service requests.</p>
                                    <div class="list-group list-group-flush">
                                        <t t-foreach="templates_by_type.get('requests', [])" t-as="template">
                                            <a t-attf-href="/my/spreadsheet/template/#{template.id}/download" 
                                               class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                                                <div>
                                                    <i class="fa fa-file-excel-o text-secondary me-2"></i>
                                                    <strong t-esc="template.name"/>
                                                    <t t-if="template.description">
                                                        <br/>
                                                        <small class="text-muted" t-esc="template.description"/>
                                                    </t>
                                                </div>
                                                <span class="badge bg-secondary">
                                                    <i class="fa fa-download"></i> Download
                                                </span>
                                            </a>
                                        </t>
                                        <t t-if="not templates_by_type.get('requests')">
                                            <div class="list-group-item text-center text-muted py-4">
                                                <i class="fa fa-file-o fa-2x mb-2 d-block"></i>
                                                No templates available
                                            </div>
                                        </t>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Inventory Items Templates -->
                        <div class="col-lg-6 mb-4">
                            <div class="card h-100">
                                <div class="card-header bg-dark text-white">
                                    <h5 class="mb-0">
                                        <i class="fa fa-cubes me-2"></i> Inventory Templates
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <p class="text-muted">Import and export inventory items.</p>
                                    <div class="list-group list-group-flush">
                                        <t t-foreach="templates_by_type.get('inventory', [])" t-as="template">
                                            <a t-attf-href="/my/spreadsheet/template/#{template.id}/download" 
                                               class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                                                <div>
                                                    <i class="fa fa-file-excel-o me-2"></i>
                                                    <strong t-esc="template.name"/>
                                                    <t t-if="template.description">
                                                        <br/>
                                                        <small class="text-muted" t-esc="template.description"/>
                                                    </t>
                                                </div>
                                                <span class="badge bg-dark">
                                                    <i class="fa fa-download"></i> Download
                                                </span>
                                            </a>
                                        </t>
                                        <t t-if="not templates_by_type.get('inventory')">
                                            <div class="list-group-item text-center text-muted py-4">
                                                <i class="fa fa-file-o fa-2x mb-2 d-block"></i>
                                                No templates available
                                            </div>
                                        </t>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Export Section -->
                    <div class="card mt-4">
                        <div class="card-header bg-light">
                            <h5 class="mb-0">
                                <i class="fa fa-download me-2"></i> Quick Export
                            </h5>
                        </div>
                        <div class="card-body">
                            <p class="text-muted mb-3">Export your existing data to spreadsheet format.</p>
                            <div class="row">
                                <div class="col-md-3 mb-2">
                                    <a href="/my/containers/export?format=xlsx" class="btn btn-outline-success w-100">
                                        <i class="fa fa-archive me-1"></i> Export Containers
                                    </a>
                                </div>
                                <div class="col-md-3 mb-2">
                                    <a href="/my/files/export?format=xlsx" class="btn btn-outline-info w-100">
                                        <i class="fa fa-folder-open me-1"></i> Export Files
                                    </a>
                                </div>
                                <div class="col-md-3 mb-2">
                                    <a href="/my/requests/export?format=xlsx" class="btn btn-outline-secondary w-100">
                                        <i class="fa fa-ticket me-1"></i> Export Requests
                                    </a>
                                </div>
                                <t t-if="is_company_admin">
                                    <div class="col-md-3 mb-2">
                                        <a href="/my/team/export?format=xlsx" class="btn btn-outline-danger w-100">
                                            <i class="fa fa-users me-1"></i> Export Users
                                        </a>
                                    </div>
                                </t>
                            </div>
                        </div>
                    </div>

                    <!-- Help Section -->
                    <div class="card mt-4">
                        <div class="card-header bg-light">
                            <h5 class="mb-0">
                                <i class="fa fa-question-circle me-2"></i> Help &amp; Tips
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-4">
                                    <h6><i class="fa fa-download text-primary me-2"></i> Downloading Templates</h6>
                                    <p class="small text-muted">
                                        Click any template to download it. Templates include column headers 
                                        and instructions in row 2.
                                    </p>
                                </div>
                                <div class="col-md-4">
                                    <h6><i class="fa fa-edit text-success me-2"></i> Filling In Data</h6>
                                    <p class="small text-muted">
                                        Start entering data from row 3. Required fields are marked with *.
                                        Follow the format shown in the sample row.
                                    </p>
                                </div>
                                <div class="col-md-4">
                                    <h6><i class="fa fa-upload text-info me-2"></i> Importing Data</h6>
                                    <p class="small text-muted">
                                        Navigate to the relevant page (Containers, Files, etc.) and use 
                                        the Import button to upload your completed spreadsheet.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </t>
        </template>

        <!-- Template Detail Page (with instructions) -->
        <template id="portal_spreadsheet_template_detail" name="Template Detail">
            <t t-call="portal.portal_layout">
                <t t-set="title" t-value="template.name"/>

                <div class="o_portal_template_detail">
                    <div class="card">
                        <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                            <h4 class="mb-0">
                                <i class="fa fa-file-excel-o me-2"></i>
                                <t t-esc="template.name"/>
                            </h4>
                            <a href="/my/spreadsheet/templates" class="btn btn-light btn-sm">
                                <i class="fa fa-arrow-left me-1"></i> Back to Templates
                            </a>
                        </div>
                        <div class="card-body">
                            <t t-if="template.description">
                                <p class="lead" t-esc="template.description"/>
                            </t>
                            
                            <div class="row mb-4">
                                <div class="col-md-6">
                                    <table class="table table-sm">
                                        <tr>
                                            <th>Type:</th>
                                            <td><span class="badge bg-secondary" t-esc="template.template_type"/></td>
                                        </tr>
                                        <tr>
                                            <th>Format:</th>
                                            <td><span class="badge bg-success" t-esc="template.format.upper()"/></td>
                                        </tr>
                                        <tr>
                                            <th>Downloads:</th>
                                            <td><t t-esc="template.download_count"/></td>
                                        </tr>
                                    </table>
                                </div>
                                <div class="col-md-6 text-end">
                                    <a t-attf-href="/my/spreadsheet/template/#{template.id}/download" 
                                       class="btn btn-success btn-lg">
                                        <i class="fa fa-download me-2"></i> Download Template
                                    </a>
                                </div>
                            </div>

                            <t t-if="template.instructions">
                                <div class="card bg-light">
                                    <div class="card-header">
                                        <h5 class="mb-0"><i class="fa fa-info-circle me-2"></i> Instructions</h5>
                                    </div>
                                    <div class="card-body">
                                        <t t-out="template.instructions"/>
                                    </div>
                                </div>
                            </t>

                            <t t-if="template.column_ids">
                                <h5 class="mt-4 mb-3"><i class="fa fa-columns me-2"></i> Column Reference</h5>
                                <div class="table-responsive">
                                    <table class="table table-bordered table-hover">
                                        <thead class="table-light">
                                            <tr>
                                                <th>Column</th>
                                                <th>Required</th>
                                                <th>Type</th>
                                                <th>Description</th>
                                                <th>Example</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <t t-foreach="template.column_ids" t-as="col">
                                                <tr>
                                                    <td><strong t-esc="col.name"/></td>
                                                    <td>
                                                        <span t-if="col.required" class="badge bg-danger">Required</span>
                                                        <span t-else="" class="badge bg-secondary">Optional</span>
                                                    </td>
                                                    <td><span class="badge bg-info" t-esc="col.data_type"/></td>
                                                    <td><t t-esc="col.instruction or '-'"/></td>
                                                    <td><code t-esc="col.sample_value or '-'"/></td>
                                                </tr>
                                            </t>
                                        </tbody>
                                    </table>
                                </div>
                            </t>
                        </div>
                    </div>
                </div>
            </t>
        </template>

    </data>
</odoo>
