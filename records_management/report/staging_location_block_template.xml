<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!--
        ============================================================================
        STAGING LOCATION BLOCK TEMPLATE

        Reusable template block for printing customer staging locations on work orders
        and invoices. Shows location hierarchy, barcode, and QR code (if available).

        Usage in reports:
            <t t-call="records_management.staging_location_block">
                <t t-set="staging_location" t-value="doc.customer_staging_location_id"/>
            </t>
        ============================================================================
        -->

        <!-- Compact inline display for tables -->
        <template id="staging_location_inline">
            <t t-if="staging_location">
                <span class="staging-location-inline">
                    <i class="fa fa-map-marker text-danger me-1" title="Staging Location"/>
                    <strong t-esc="staging_location.complete_name"/>
                    <t t-if="staging_location.barcode">
                        <small class="text-muted ms-2">(<t t-esc="staging_location.barcode"/>)</small>
                    </t>
                </span>
            </t>
        </template>

        <!-- Full block with barcode for work orders -->
        <template id="staging_location_block">
            <t t-if="staging_location">
                <div class="staging-location-block border rounded p-3 mb-3" style="background-color: #f8f9fa;">
                    <div class="row">
                        <div class="col-8">
                            <h5 class="mb-2">
                                <i class="fa fa-map-marker text-danger me-1"/> Service/Staging Location
                            </h5>
                            <p class="mb-1">
                                <strong>Location Path:</strong><br/>
                                <span class="h6" t-esc="staging_location.complete_name"/>
                            </p>
                            <t t-if="staging_location.location_type">
                                <p class="mb-1 text-muted">
                                    <small>Type: <t t-esc="dict(staging_location._fields['location_type'].selection).get(staging_location.location_type, '')"/></small>
                                </p>
                            </t>
                            <t t-if="staging_location.notes">
                                <p class="mb-0 text-muted">
                                    <small><i class="fa fa-info-circle me-1" title="Notes"/>Notes: <t t-esc="staging_location.notes"/></small>
                                </p>
                            </t>
                        </div>
                        <div class="col-4 text-center">
                            <t t-if="staging_location.barcode">
                                <div class="barcode-container">
                                    <!-- Barcode display -->
                                    <p class="mb-1"><small class="text-muted">Scan to verify location:</small></p>
                                    <img t-att-src="'/report/barcode/Code128/%s' % staging_location.barcode"
                                         style="max-width: 150px; height: 40px;"
                                         alt="Staging Location Barcode"/>
                                    <p class="mt-1 mb-0">
                                        <code t-esc="staging_location.barcode"/>
                                    </p>
                                </div>
                            </t>
                            <t t-else="">
                                <p class="text-muted mb-0">
                                    <small><i class="fa fa-barcode me-1"/>No barcode assigned</small>
                                </p>
                            </t>
                        </div>
                    </div>
                </div>
            </t>
        </template>

        <!-- Minimal block without barcode image (for invoices) -->
        <template id="staging_location_block_minimal">
            <t t-if="staging_location">
                <div class="staging-location-minimal mb-2">
                    <p class="mb-0">
                        <i class="fa fa-map-marker text-danger me-1" title="Service Location"/>
                        <strong>Service Location:</strong>
                        <t t-esc="staging_location.complete_name"/>
                        <t t-if="staging_location.barcode">
                            <span class="text-muted"> [<t t-esc="staging_location.barcode"/>]</span>
                        </t>
                    </p>
                </div>
            </t>
        </template>

        <!-- Table row version for container lists -->
        <template id="staging_location_table_cell">
            <t t-if="staging_location">
                <td class="staging-location-cell">
                    <t t-esc="staging_location.name or staging_location.complete_name"/>
                    <t t-if="staging_location.barcode">
                        <br/><small class="text-muted"><t t-esc="staging_location.barcode"/></small>
                    </t>
                </td>
            </t>
            <t t-else="">
                <td class="text-muted">-</td>
            </t>
        </template>

    </data>
</odoo>
