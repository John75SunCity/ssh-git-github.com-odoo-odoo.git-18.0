<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <template id="report_revenue_forecasting">
        <t t-call="web.html_container">
            <div class="page">
                <div class="header text-center">
                    <h1>Revenue Forecasting Report</h1>
                    <p>Financial Analytics and Predictions</p>
                </div>

                <div class="report-period mt-4">
                    <p>
                        <strong>Analysis Period:</strong>
                        <span t-esc="context.get('date_from', 'Last 12 months')"/>
 to <span t-esc="context.get('date_to', 'Current')"/>
                    </p>
                    <p>
                        <strong>Generated On:</strong>
                        <span t-esc="datetime.datetime.now().strftime('%Y-%m-%d %H:%M')"/>
                    </p>
                </div>

                <div class="financial-summary mt-4">
                    <h3>Revenue Summary</h3>
                    <div class="row">
                        <div class="col-3">
                            <div class="metric-card text-center">
                                <h4 class="text-success">$                                    <span t-esc="format(docs.get('current_month_revenue', 0), ',.2f')"/>
                                </h4>
                                <p>Current Month</p>
                            </div>
                        </div>
                        <div class="col-3">
                            <div class="metric-card text-center">
                                <h4 class="text-info">$                                    <span t-esc="format(docs.get('projected_next_month', 0), ',.2f')"/>
                                </h4>
                                <p>Next Month Forecast</p>
                            </div>
                        </div>
                        <div class="col-3">
                            <div class="metric-card text-center">
                                <h4 class="text-primary">$                                    <span t-esc="format(docs.get('quarterly_projection', 0), ',.2f')"/>
                                </h4>
                                <p>Quarterly Projection</p>
                            </div>
                        </div>
                        <div class="col-3">
                            <div class="metric-card text-center">
                                <h4 class="text-warning">
                                    <span t-esc="format(docs.get('growth_rate', 0), '.1f')"/>
%</h4>
                                <p>Growth Rate</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="monthly-forecast mt-4">
                    <h3>Monthly Forecast Analysis</h3>
                    <table class="table table-striped table-bordered">
                        <thead class="table-dark">
                            <tr>
                                <th>Month</th>
                                <th>Actual Revenue</th>
                                <th>Forecasted Revenue</th>
                                <th>Variance</th>
                                <th>Confidence Level</th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-foreach="docs.get('monthly_data', [])" t-as="month_data">
                                <tr>
                                    <td>
                                        <span t-esc="month_data.get('month', '')"/>
                                    </td>
                                    <td>$                                        <span t-esc="format(month_data.get('actual', 0), ',.2f')"/>
                                    </td>
                                    <td>$                                        <span t-esc="format(month_data.get('forecast', 0), ',.2f')"/>
                                    </td>
                                    <td>
                                        <span t-att-class="'text-success' if month_data.get('variance', 0) >= 0 else 'text-danger'">
                                            <span t-esc="format(month_data.get('variance', 0), '.1f')"/>
%
                                        </span>
                                    </td>
                                    <td>
                                        <span t-esc="format(month_data.get('confidence', 0), '.1f')"/>
%</td>
                                </tr>
                            </t>
                        </tbody>
                    </table>
                </div>

                <div class="revenue-sources mt-4">
                    <h3>Revenue by Service Type</h3>
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>Service Type</th>
                                <th>Current Revenue</th>
                                <th>Projected Revenue</th>
                                <th>Growth %</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Document Storage</td>
                                <td>$                                    <span t-esc="format(docs.get('storage_revenue', 0), ',.2f')"/>
                                </td>
                                <td>$                                    <span t-esc="format(docs.get('storage_projection', 0), ',.2f')"/>
                                </td>
                                <td>
                                    <span t-esc="format(docs.get('storage_growth', 0), '.1f')"/>
%</td>
                            </tr>
                            <tr>
                                <td>Shredding Services</td>
                                <td>$                                    <span t-esc="format(docs.get('shredding_revenue', 0), ',.2f')"/>
                                </td>
                                <td>$                                    <span t-esc="format(docs.get('shredding_projection', 0), ',.2f')"/>
                                </td>
                                <td>
                                    <span t-esc="format(docs.get('shredding_growth', 0), '.1f')"/>
%</td>
                            </tr>
                            <tr>
                                <td>Pickup Services</td>
                                <td>$                                    <span t-esc="format(docs.get('pickup_revenue', 0), ',.2f')"/>
                                </td>
                                <td>$                                    <span t-esc="format(docs.get('pickup_projection', 0), ',.2f')"/>
                                </td>
                                <td>
                                    <span t-esc="format(docs.get('pickup_growth', 0), '.1f')"/>
%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="methodology mt-4">
                    <h4>Forecasting Methodology</h4>
                    <p>This forecast uses advanced statistical analysis including:</p>
                    <ul>
                        <li>Historical trend analysis (12-month rolling average)</li>
                        <li>Seasonal adjustment factors</li>
                        <li>Customer growth patterns</li>
                        <li>Market expansion indicators</li>
                    </ul>
                    <p>
                        <em>Confidence levels are based on historical accuracy and market volatility.</em>
                    </p>
                </div>
            </div>
        </t>
    </template>

    <record id="action_report_revenue_forecasting" model="ir.actions.report">
        <field name="name">Revenue Forecasting Report</field>
        <field name="model">account.move</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">records_management.report_revenue_forecasting</field>
        <field name="report_file">records_management.report_revenue_forecasting</field>
        <field name="binding_type">report</field>
    </record>
</odoo>
